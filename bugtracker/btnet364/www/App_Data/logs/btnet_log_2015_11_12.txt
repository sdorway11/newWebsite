2015-11-12 21:15:15  caught exception in util.set_context:Request is not available in this context
2015-11-12 21:15:15  threadproc_votes
2015-11-12 21:15:15  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2015-11-12 21:15:15  started creating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 21:15:15  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 21:15:15  exception in threadproc_votes:Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:15:15  exception building Lucene index: Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:15:15     at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.MyLucene.get_text_custom_cols() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 78
   at btnet.MyLucene.threadproc_build(Object obj) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 145
2015-11-12 21:24:48  caught exception in util.set_context:Request is not available in this context
2015-11-12 21:24:48  threadproc_votes
2015-11-12 21:24:48  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2015-11-12 21:24:48  started creating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 21:24:48  exception in threadproc_votes:Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:24:48  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 21:24:48  exception building Lucene index: Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:24:48     at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.MyLucene.get_text_custom_cols() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 78
   at btnet.MyLucene.threadproc_build(Object obj) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 145
2015-11-12 21:27:31 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'kiresorg'

TIME: 9:27:31 PM
MSG: Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.Data.SqlClient.SqlException (0x80131904): Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.DbUtil.get_datarow(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 174
   at btnet.Authenticate.check_password(String username, String password) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\authenticate.cs:line 28
   at ASP.default_aspx.on_logon() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 138
   at ASP.default_aspx.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 122
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
ClientConnectionId:fc2f4bc9-d3d8-4c25-a0c8-195c17775cd3
Error Number:4060,State:1,Class:11

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:939
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 939
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=939
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1184
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=939
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:27:31 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:28:38  caught exception in util.set_context:Request is not available in this context
2015-11-12 21:28:38  threadproc_votes
2015-11-12 21:28:38  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2015-11-12 21:28:38  started creating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 21:28:38  exception in threadproc_votes:Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:28:38  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 21:28:38  exception building Lucene index: Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:28:38 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'kiresorg'
2015-11-12 21:28:38     at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.MyLucene.get_text_custom_cols() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 78
   at btnet.MyLucene.threadproc_build(Object obj) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 145

TIME: 9:28:38 PM
MSG: Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.Data.SqlClient.SqlException (0x80131904): Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.DbUtil.get_datarow(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 174
   at btnet.Authenticate.check_password(String username, String password) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\authenticate.cs:line 28
   at ASP.default_aspx.on_logon() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 138
   at ASP.default_aspx.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 122
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
ClientConnectionId:da607fa3-cf65-4b42-82f8-31cb193e270d
Error Number:4060,State:1,Class:11

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:939
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 939
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=939
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1184
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=939
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:28:38 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'kiresorg'

TIME: 9:29:09 PM
MSG: No process is on the other end of the pipe
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.ComponentModel.Win32Exception (0x80004005): No process is on the other end of the pipe

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:933
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 933
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=933
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1184
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=933
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx There was a problem sending email.   Check settings in Web.config.
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx TO:admin@example.com
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx FROM:errors@example.com
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx SUBJECT:Error: No process is on the other end of the pipe
2015-11-12 21:29:09 http://www.learncodinganywhere.com/bugtracker/default.aspx Could not find a part of the path 'C:\temp\pickup\4a304289-fc27-43a4-9a79-a698b5f97751.eml'.
2015-11-12 21:32:04  caught exception in util.set_context:Request is not available in this context
2015-11-12 21:32:04  threadproc_votes
2015-11-12 21:32:04  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2015-11-12 21:32:04  started creating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 21:32:04  exception in threadproc_votes:Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:32:04  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 21:32:04  exception building Lucene index: Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
2015-11-12 21:32:04     at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.MyLucene.get_text_custom_cols() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 78
   at btnet.MyLucene.threadproc_build(Object obj) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\my_lucene.cs:line 145
2015-11-12 21:32:13 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'kiresorg'

TIME: 9:32:13 PM
MSG: Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.Data.SqlClient.SqlException (0x80131904): Cannot open database "bugtracker" requested by the login. The login failed.
Login failed for user 'IIS APPPOOL\newWebsite'.
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at btnet.DbUtil.get_sqlconnection() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 191
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 138
   at btnet.DbUtil.get_datarow(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 174
   at btnet.Authenticate.check_password(String username, String password) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\authenticate.cs:line 28
   at ASP.default_aspx.on_logon() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 138
   at ASP.default_aspx.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 122
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
ClientConnectionId:15099e52-bbef-4b4f-b0d2-6d7b44197991
Error Number:4060,State:1,Class:11

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:947
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 947
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=947
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1185
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=947
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:32:13 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:39:04 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:39:04 http://www.learncodinganywhere.com/bugtracker/default.aspx Invalid object name 'users'.
2015-11-12 21:39:04 http://www.learncodinganywhere.com/bugtracker/default.aspx server=TECHACADEMYTFS\TADB1;database=bugtracker;Integrated Security=SSPI;
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx Invalid object name 'users'.
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx server=TECHACADEMYTFS\TADB1;database=bugtracker;Integrated Security=SSPI;
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'

TIME: 9:39:41 PM
MSG: Invalid object name 'users'.
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'users'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 144
   at btnet.DbUtil.get_datarow(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 174
   at btnet.Authenticate.check_password(String username, String password) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\authenticate.cs:line 28
   at ASP.default_aspx.on_logon() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 138
   at ASP.default_aspx.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 122
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
ClientConnectionId:28f92112-3905-4488-a75c-623fe1dbb46d
Error Number:208,State:1,Class:16

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:589
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 589
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=589
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1187
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=589
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx There was a problem sending email.   Check settings in Web.config.
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx TO:admin@example.com
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx FROM:errors@example.com
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx SUBJECT:Error: Invalid object name 'users'.
2015-11-12 21:39:41 http://www.learncodinganywhere.com/bugtracker/default.aspx Could not find a part of the path 'C:\temp\pickup\62ad8fea-d300-4286-8457-c67bf49693f1.eml'.
2015-11-12 21:40:22 http://www.learncodinganywhere.com/bugtracker/install.aspx?dbname=bugtracker sql=
use master
				create database [bugtracker]
2015-11-12 21:40:43 http://www.learncodinganywhere.com/bugtracker/install.aspx?dbname=bugs sql=
use master
				create database [bugs]
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx Invalid object name 'users'.
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx server=TECHACADEMYTFS\TADB1;database=bugtracker;Integrated Security=SSPI;
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'

TIME: 9:41:23 PM
MSG: Invalid object name 'users'.
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'users'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 144
   at btnet.DbUtil.get_datarow(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 174
   at btnet.Authenticate.check_password(String username, String password) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\authenticate.cs:line 28
   at ASP.default_aspx.on_logon() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 138
   at ASP.default_aspx.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 122
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
ClientConnectionId:0e620738-6654-4277-a377-8a803700abb8
Error Number:208,State:1,Class:16

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:589
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 589
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=589
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1187
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=589
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx There was a problem sending email.   Check settings in Web.config.
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx TO:admin@example.com
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx FROM:errors@example.com
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx SUBJECT:Error: Invalid object name 'users'.
2015-11-12 21:41:23 http://www.learncodinganywhere.com/bugtracker/default.aspx Could not find a part of the path 'C:\temp\pickup\602cc2c7-88ed-43d1-99c3-0dda6c4fbbc4.eml'.
2015-11-12 21:42:53 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:42:53 http://www.learncodinganywhere.com/bugtracker/default.aspx Invalid object name 'users'.
2015-11-12 21:42:53 http://www.learncodinganywhere.com/bugtracker/default.aspx server=TECHACADEMYTFS\TADB1;database=bugtracker;Integrated Security=SSPI;
2015-11-12 21:46:43 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:46:43 http://www.learncodinganywhere.com/bugtracker/default.aspx Invalid object name 'users'.
2015-11-12 21:46:43 http://www.learncodinganywhere.com/bugtracker/default.aspx server=TECHACADEMYTFS\TADB1;database=bugtracker;Integrated Security=SSPI;
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx Invalid object name 'users'.
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx server=TECHACADEMYTFS\TADB1;database=bugtracker;Integrated Security=SSPI;
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'

TIME: 9:46:52 PM
MSG: Invalid object name 'users'.
URL: http://www.learncodinganywhere.com/bugtracker/default.aspx
EXCEPTION: System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'users'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)
   at btnet.DbUtil.get_dataset(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 144
   at btnet.DbUtil.get_datarow(String sql) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\dbutil.cs:line 174
   at btnet.Authenticate.check_password(String username, String password) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Code\authenticate.cs:line 28
   at ASP.default_aspx.on_logon() in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 138
   at ASP.default_aspx.Page_Load(Object sender, EventArgs e) in c:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx:line 122
   at System.Web.UI.Control.OnLoad(EventArgs e)
   at System.Web.UI.Control.LoadRecursive()
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
ClientConnectionId:0e620738-6654-4277-a377-8a803700abb8
Error Number:208,State:1,Class:16

ALL_HTTP=HTTP_CACHE_CONTROL:max-age=0
HTTP_CONNECTION:keep-alive
HTTP_CONTENT_LENGTH:607
HTTP_CONTENT_TYPE:application/x-www-form-urlencoded
HTTP_ACCEPT:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING:gzip, deflate
HTTP_ACCEPT_LANGUAGE:en-US,en;q=0.8
HTTP_HOST:www.learncodinganywhere.com
HTTP_REFERER:http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT:Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN:http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS:1

ALL_RAW=Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 607
Content-Type: application/x-www-form-urlencoded
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Host: www.learncodinganywhere.com
Referer: http://www.learncodinganywhere.com/bugtracker/
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
Origin: http://www.learncodinganywhere.com
Upgrade-Insecure-Requests: 1

APPL_MD_PATH=/LM/W3SVC/8/ROOT/bugtracker
APPL_PHYSICAL_PATH=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\
CONTENT_LENGTH=607
CONTENT_TYPE=application/x-www-form-urlencoded
GATEWAY_INTERFACE=CGI/1.1
HTTPS=off
INSTANCE_ID=8
INSTANCE_META_PATH=/LM/W3SVC/8
LOCAL_ADDR=100.72.92.43
PATH_INFO=/bugtracker/default.aspx
PATH_TRANSLATED=C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\default.aspx
REMOTE_ADDR=104.40.28.180
REMOTE_HOST=104.40.28.180
REMOTE_PORT=1325
REQUEST_METHOD=POST
SCRIPT_NAME=/bugtracker/default.aspx
SERVER_NAME=www.learncodinganywhere.com
SERVER_PORT=80
SERVER_PORT_SECURE=0
SERVER_PROTOCOL=HTTP/1.1
SERVER_SOFTWARE=Microsoft-IIS/8.5
URL=/bugtracker/default.aspx
HTTP_CACHE_CONTROL=max-age=0
HTTP_CONNECTION=keep-alive
HTTP_CONTENT_LENGTH=607
HTTP_CONTENT_TYPE=application/x-www-form-urlencoded
HTTP_ACCEPT=text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
HTTP_ACCEPT_ENCODING=gzip, deflate
HTTP_ACCEPT_LANGUAGE=en-US,en;q=0.8
HTTP_HOST=www.learncodinganywhere.com
HTTP_REFERER=http://www.learncodinganywhere.com/bugtracker/
HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36
HTTP_ORIGIN=http://www.learncodinganywhere.com
HTTP_UPGRADE_INSECURE_REQUESTS=1
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx to email addr: admin@example.com
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx There was a problem sending email.   Check settings in Web.config.
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx TO:admin@example.com
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx FROM:errors@example.com
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx SUBJECT:Error: Invalid object name 'users'.
2015-11-12 21:46:52 http://www.learncodinganywhere.com/bugtracker/default.aspx Could not find a part of the path 'C:\temp\pickup\6acdc984-7e96-463b-9363-df8237bd3b27.eml'.
2015-11-12 21:47:01 http://www.learncodinganywhere.com/bugtracker/query.aspx sql=
select count(1) from users
2015-11-12 21:47:01 http://www.learncodinganywhere.com/bugtracker/query.aspx sql=
select name from sysobjects where type = 'u' order by 1
2015-11-12 21:47:01 http://www.learncodinganywhere.com/bugtracker/query.aspx elapsed milliseconds:0169
2015-11-12 21:47:34 http://www.learncodinganywhere.com/bugtracker/query.aspx sql=
select count(1) from users
2015-11-12 21:47:34 http://www.learncodinganywhere.com/bugtracker/query.aspx sql=
--Copyright 2002-2009 Corey Trager
--Distributed under the terms of the GNU General Public License

if exists (select * from dbo.sysobjects where id = object_id(N'[bug_posts]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bug_posts]

if exists (select * from dbo.sysobjects where id = object_id(N'[bug_subscriptions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bug_subscriptions]

if exists (select * from dbo.sysobjects where id = object_id(N'[bugs]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bugs]

if exists (select * from dbo.sysobjects where id = object_id(N'[categories]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [categories]

if exists (select * from dbo.sysobjects where id = object_id(N'[priorities]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [priorities]

if exists (select * from dbo.sysobjects where id = object_id(N'[project_user_xref]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [project_user_xref]

if exists (select * from dbo.sysobjects where id = object_id(N'[projects]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [projects]

if exists (select * from dbo.sysobjects where id = object_id(N'[queries]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [queries]

if exists (select * from dbo.sysobjects where id = object_id(N'[reports]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [reports]

if exists (select * from dbo.sysobjects where id = object_id(N'[sessions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [sessions]

if exists (select * from dbo.sysobjects where id = object_id(N'[statuses]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [statuses]

if exists (select * from dbo.sysobjects where id = object_id(N'[user_defined_attribute]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [user_defined_attribute]

if exists (select * from dbo.sysobjects where id = object_id(N'[users]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [users]

if exists (select * from dbo.sysobjects where id = object_id(N'[bug_relationships]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bug_relationships]

if exists (select * from dbo.sysobjects where id = object_id(N'[custom_col_metadata]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [custom_col_metadata]

if exists (select * from dbo.sysobjects where id = object_id(N'[svn_affected_paths]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [svn_affected_paths]

if exists (select * from dbo.sysobjects where id = object_id(N'[svn_revisions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [svn_revisions]

if exists (select * from dbo.sysobjects where id = object_id(N'[bug_post_attachments]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bug_post_attachments]

if exists (select * from dbo.sysobjects where id = object_id(N'[orgs]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [orgs]

if exists (select * from dbo.sysobjects where id = object_id(N'[bug_user]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bug_user]

if exists (select * from dbo.sysobjects where id = object_id(N'[emailed_links]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [emailed_links]

if exists (select * from dbo.sysobjects where id = object_id(N'[queued_notifications]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [queued_notifications]

if exists (select * from dbo.sysobjects where id = object_id(N'[dashboard_items]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [dashboard_items]

if exists (select * from dbo.sysobjects where id = object_id(N'[bug_tasks]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [bug_tasks]

if exists (select * from dbo.sysobjects where id = object_id(N'[git_affected_paths]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [git_affected_paths]

if exists (select * from dbo.sysobjects where id = object_id(N'[git_commits]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [git_commits]

if exists (select * from dbo.sysobjects where id = object_id(N'[hg_affected_paths]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [hg_affected_paths]

if exists (select * from dbo.sysobjects where id = object_id(N'[hg_revisions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
drop table [hg_revisions]

/* org */

create table orgs
(
og_id int identity constraint pk_orgs primary key not null,
og_name nvarchar(80) not null,
og_domain nvarchar(80),
og_non_admins_can_use int not null default(0),
og_external_user int not null default(0), /* external user can't view post marked internal */
og_can_be_assigned_to int not null default(1),
og_can_only_see_own_reported int not null default(0),
og_can_edit_sql int not null default(0),
og_can_delete_bug int not null default(0),
og_can_edit_and_delete_posts int not null default(0),
og_can_merge_bugs int not null default(0),
og_can_mass_edit_bugs int not null default(0),
og_can_use_reports int not null default(0),
og_can_edit_reports int not null default(0),
og_can_view_tasks int not null default(0),
og_can_edit_tasks int not null default(0),
og_can_search int not null default(1),
og_other_orgs_permission_level int not null default(2), -- 0=none, 1=read, 2=edit
og_can_assign_to_internal_users int not null default(0),

og_category_field_permission_level int not null default(2), -- 0=none, 1=read, 2=edit
og_priority_field_permission_level int not null default(2),
og_assigned_to_field_permission_level int not null default(2),
og_status_field_permission_level int not null default(2),
og_project_field_permission_level int not null default(2),
og_org_field_permission_level int not null default(2),
og_udf_field_permission_level int not null default(2),
og_tags_field_permission_level int not null default(2),
og_active int not null default(1)
)

create unique index unique_og_name on orgs (og_name)

insert into orgs (og_name, og_external_user, og_can_be_assigned_to, og_other_orgs_permission_level) values ('org1',0,1,2)
insert into orgs (og_name, og_external_user, og_can_be_assigned_to, og_other_orgs_permission_level) values ('developers',0,1,2)
insert into orgs (og_name, og_external_user, og_can_be_assigned_to, og_other_orgs_permission_level) values ('testers',0,1,2)
insert into orgs (og_name, og_external_user, og_can_be_assigned_to, og_other_orgs_permission_level) values ('client one',1,0,0)
insert into orgs (og_name, og_external_user, og_can_be_assigned_to, og_other_orgs_permission_level) values ('client two',1,0,0)

/* USER */

create table users
(
us_id int identity constraint pk_users primary key not null,
us_username nvarchar(40) not null,
us_salt int null,
us_password nvarchar(64) not null,
us_firstname nvarchar(60) null,
us_lastname nvarchar(60) null,
us_email nvarchar(120) null,
us_admin int not null default(0),
us_default_query int not null default(0),
us_enable_notifications int not null default(1),
us_auto_subscribe int not null default(0),
us_auto_subscribe_own_bugs int null default(0),
us_auto_subscribe_reported_bugs int null default(0),
us_send_notifications_to_self int null default(0),
us_active int not null default(1),
us_bugs_per_page int null,
us_forced_project int null,
us_reported_notifications int not null default(4),
us_assigned_notifications int not null default(4),
us_subscribed_notifications int not null default(4),
us_signature nvarchar(1000) null,
us_use_fckeditor int not null default(0),
us_enable_bug_list_popups int not null default(1),
/* who created this user */
us_created_user int not null default(1),
us_org int not null default(1),
us_most_recent_login_datetime datetime null
)

create unique index unique_us_username on users (us_username)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_org)
values ('admin', 'System', 'Administrator', 'admin', 1, 1, 1)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_org)
values ('developer', 'Al', 'Kaline', 'admin', 0, 2, 2)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_org)
values ('tester', 'Norman', 'Cash', 'admin', 0, 4, 4)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_org)
values ('customer1', 'Bill', 'Freehan', 'admin', 0, 1, 4)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_org)
values ('customer2', 'Denny', 'McClain', 'admin', 0, 1, 5)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query)
values ('email', 'for POP3', 'btnet_service.exe', 'x', 0, 1)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_forced_project)
values ('viewer', 'Read', 'Only', 'admin', 0, 1, 1)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_forced_project)
values ('reporter', 'Report And', 'Comment Only', 'admin', 0, 1, 1)

insert into users (
us_username, us_firstname, us_lastname, us_password, us_admin, us_default_query, us_forced_project, us_active)
values ('guest', 'Special', 'cannot save searches, settings', 'guest', 0, 1, 1, 0)

/* SESSIONS */

create table sessions
(
	se_id char(37) constraint pk_sessions primary key not null,
	se_date datetime not null default(getdate()),
	se_user int not null
)




/* EMAILED LINKS */


create table emailed_links
(
el_id char(37) constraint pk_emailed_links primary key not null,
el_date datetime not null default(getdate()),
el_email nvarchar(120) not null,
el_action nvarchar(20) not null, -- "registration" or "forgot"
el_username nvarchar(40) null,
el_user_id int null,
el_salt int null,
el_password nvarchar(64) null,
el_firstname nvarchar(60) null,
el_lastname nvarchar(60) null
)

/* CATEGORIES */

create table categories
(
ct_id int identity constraint pk_categories primary key not null,
ct_name nvarchar(80) not null,
ct_sort_seq int not null default(0),
ct_default int not null default(0)
)

create unique index unique_ct_name on categories (ct_name)


insert into categories (ct_name) values('bug')
insert into categories (ct_name) values('enhancement')
insert into categories (ct_name) values('task')
insert into categories (ct_name) values('question')
insert into categories (ct_name) values('ticket')

/* PROJECTS */

create table projects
(
pj_id int identity constraint pk_projects primary key not null,
pj_name nvarchar(80) not null,
pj_active int not null default(1),
pj_default_user int null,
pj_auto_assign_default_user int null,
pj_auto_subscribe_default_user int null,
pj_enable_pop3 int null,
pj_pop3_username varchar(50) null,
pj_pop3_password nvarchar(20) null,
pj_pop3_email_from nvarchar(120) null,
pj_enable_custom_dropdown1 int not null default(0),
pj_enable_custom_dropdown2 int not null default(0),
pj_enable_custom_dropdown3 int not null default(0),
pj_custom_dropdown_label1 nvarchar(80) null,
pj_custom_dropdown_label2 nvarchar(80) null,
pj_custom_dropdown_label3 nvarchar(80) null,
pj_custom_dropdown_values1 nvarchar(800) null,
pj_custom_dropdown_values2 nvarchar(800) null,
pj_custom_dropdown_values3 nvarchar(800) null,
pj_default int not null default(0),
pj_description nvarchar(200) null
)

create unique index unique_pj_name on projects (pj_name)

insert into projects (pj_name) values('project 1')
insert into projects (pj_name) values('project 2')


/* BUGS */

create table bugs 
(
bg_id int identity constraint pk_bugs primary key not null,
bg_short_desc nvarchar(200) not null,
bg_reported_user int not null,
bg_reported_date datetime not null,
bg_status int not null,
bg_priority int not null,
bg_org int not null,
bg_category int not null,
bg_project int not null,
bg_assigned_to_user int null,
bg_last_updated_user int null,
bg_last_updated_date datetime null,
bg_user_defined_attribute int null,
bg_project_custom_dropdown_value1 nvarchar(120) null,
bg_project_custom_dropdown_value2 nvarchar(120) null,
bg_project_custom_dropdown_value3 nvarchar(120) null,
bg_tags nvarchar(200) null
)

/* BUG POSTS  - comments, attachments, change history */

create table bug_posts
(
bp_id int identity constraint pk_bug_posts primary key nonclustered not null,
bp_bug int not null,
bp_type varchar(8) not null,
bp_user int not null,
bp_date datetime not null,
bp_comment ntext not null,
bp_comment_search ntext null,
bp_email_from nvarchar(800) null,
bp_email_to nvarchar(800) null,
bp_file nvarchar(1000) null,
bp_size int null,
bp_content_type nvarchar(200) null,
bp_parent int null,
bp_original_comment_id int null,
bp_hidden_from_external_users int not null default(0),
bp_email_cc nvarchar(800) null
)

create clustered index bp_index_1 on bug_posts (bp_bug)


/* BUG TASKS - subtasks and time tracking */

create table bug_tasks
(
tsk_id int identity constraint pk_bug_tasks primary key nonclustered not null,
tsk_bug int not null,
tsk_created_user int not null,
tsk_created_date datetime not null,
tsk_last_updated_user int not null,
tsk_last_updated_date datetime not null,

tsk_assigned_to_user int null,
tsk_planned_start_date datetime null,
tsk_actual_start_date datetime null,
tsk_planned_end_date datetime null,
tsk_actual_end_date datetime null,
tsk_planned_duration decimal(6,2) null,
tsk_actual_duration decimal(6,2) null,
tsk_duration_units nvarchar(20) null,
tsk_percent_complete int null,
tsk_status int null,
tsk_sort_sequence int null,
tsk_description nvarchar(400) null,
)

create clustered index tsk_index_1 on bug_tasks (tsk_bug)

/* BUG POST ATTACHMENTS -- database storage of attachments */

create table bug_post_attachments
(
bpa_id int identity constraint pk_bug_post_attachements primary key not null,
bpa_post int not null,
bpa_content image not null
)

create unique index bpa_index on bug_post_attachments (bpa_post)

/* BUG USER SUBSCRIPTIONS */

create table bug_subscriptions
(
bs_bug int not null,
bs_user int not null,
)

create unique index bs_index_1 on bug_subscriptions (bs_user, bs_bug)
create unique clustered index bs_index_2 on bug_subscriptions (bs_bug, bs_user)

/* BUG USER */

create table bug_user
(
bu_bug int not null,
bu_user int not null,
bu_flag int not null,
bu_flag_datetime datetime null,
bu_seen int not null,
bu_seen_datetime datetime null,
bu_vote int not null,
bu_vote_datetime datetime null,
)

create unique clustered index bu_index_1 on bug_user (bu_bug, bu_user)

/* BUG RELATIONSHIPS */

create table bug_relationships
(
re_id int identity constraint pk_bug_relationships primary key not null,
re_bug1 int not null,
re_bug2 int not null,
re_type nvarchar(500) null,
re_direction int not null
)

create unique index re_index_1 on bug_relationships (re_bug1, re_bug2)
create unique index re_index_2 on bug_relationships (re_bug2, re_bug1)


/* PROJECT USER XREF */

create table project_user_xref
(
pu_id int identity constraint pk_project_user_xref primary key not null,
pu_project int not null,
pu_user int not null,
pu_auto_subscribe int not null default(0),
/* 0=none, 1=view only, 2=edit, 3=reporter */
pu_permission_level int not null default(2),
pu_admin int not null default(0),
)

create unique index pu_index_1 on project_user_xref (pu_project, pu_user)
create unique index pu_index_2 on project_user_xref (pu_user, pu_project)

insert into project_user_xref (pu_project, pu_user, pu_permission_level) values (1,7,1)
insert into project_user_xref (pu_project, pu_user, pu_permission_level) values (2,7,1)
insert into project_user_xref (pu_project, pu_user, pu_permission_level) values (1,8,3)
insert into project_user_xref (pu_project, pu_user, pu_permission_level) values (2,8,0)
insert into project_user_xref (pu_project, pu_user, pu_permission_level) values (1,9,1)
insert into project_user_xref (pu_project, pu_user, pu_permission_level) values (2,9,1)

/* USER DEFINED ATTRIBUTE */

create table user_defined_attribute
(
udf_id int identity constraint pk_user_defined_attribute primary key not null,
udf_name nvarchar(60) not null,
udf_sort_seq int not null default(0),
udf_default int not null default(0)
)

create unique index unique_udf_name on user_defined_attribute (udf_name)

insert into user_defined_attribute (udf_name) values ('whatever')
insert into user_defined_attribute (udf_name) values ('anything')


/* STATUSES */

create table statuses
(
st_id int identity constraint pk_statuses primary key not null,
st_name nvarchar(60) not null,
st_sort_seq int not null default(0),
st_style nvarchar(30) null,
st_default int not null default(0)
)

create unique index unique_st_name on statuses (st_name)

insert into statuses (st_name, st_sort_seq, st_style, st_default) values ('new', 1, 'st1', 1)
insert into statuses (st_name, st_sort_seq, st_style, st_default) values ('in progress', 2, 'st2', 0)
insert into statuses (st_name, st_sort_seq, st_style, st_default) values ('checked in', 3, 'st3', 0)
insert into statuses (st_name, st_sort_seq, st_style, st_default) values ('re-opened', 4, 'st4', 0)
insert into statuses (st_name, st_sort_seq, st_style, st_default) values ('closed', 5, 'st5', 0)

/* PRIORITIES */

create table priorities
(
pr_id int identity constraint pk_priorities primary key not null,
pr_name nvarchar(60) not null,
pr_sort_seq int not null default(0),
pr_background_color nvarchar(14) not null,
pr_style nvarchar(30) null,
pr_default int not null default(0)
)

create unique index unique_pr_name on priorities (pr_name)

insert into priorities (pr_name, pr_sort_seq, pr_background_color, pr_style) values ('high', 1, '#ff9999', 'pr1_')
insert into priorities (pr_name, pr_sort_seq, pr_background_color, pr_style) values ('med', 2, '#ffdddd', 'pr2_')
insert into priorities (pr_name, pr_sort_seq, pr_background_color, pr_style) values ('low', 3, '#ffffff', 'pr3_')


/* CUSTOM COL METADATA */

create table custom_col_metadata
(
ccm_colorder int constraint pk_custom_col_metadata primary key not null,
ccm_dropdown_vals nvarchar(1000) not null default(''),
ccm_sort_seq int default(0),
ccm_dropdown_type varchar(20) null
)

/* SVN REVISIONS */

create table svn_revisions
(
svnrev_id int identity constraint pk_svn_revisions primary key nonclustered not null,
svnrev_revision int not null,
svnrev_bug int not null,
svnrev_repository nvarchar(400) not null,
svnrev_author nvarchar(100) not null,
svnrev_svn_date nvarchar(100) not null,
svnrev_btnet_date datetime not null,
svnrev_msg ntext not null
)

create clustered index svn_bug_index on svn_revisions (svnrev_bug)


/* SVN AFFECTED PATHS */

create table svn_affected_paths
(
svnap_id int identity constraint pk_svn_affected_paths primary key nonclustered not null,
svnap_svnrev_id int not null,
svnap_action nvarchar(8) not null,
svnap_path nvarchar(400) not null
)

create clustered index svn_revision_index on svn_affected_paths (svnap_svnrev_id)


/* GIT COMMITS */

create table git_commits
(
gitcom_id int identity constraint pk_git_commits primary key nonclustered not null,
gitcom_commit char(40),
gitcom_bug int not null,
gitcom_repository nvarchar(400) not null,
gitcom_author nvarchar(100) not null,
gitcom_git_date nvarchar(100) not null,
gitcom_btnet_date datetime not null,
gitcom_msg ntext not null
)

create clustered index git_bug_index on git_commits (gitcom_bug)

create unique index git_unique_commit on git_commits (gitcom_commit)

create table git_affected_paths
(
gitap_id int identity constraint pk_git_affected_paths primary key nonclustered not null,
gitap_gitcom_id int not null,
gitap_action nvarchar(8) not null,
gitap_path nvarchar(400) not null
)

create clustered index gitap_gitcom_index on git_affected_paths (gitap_gitcom_id)

/* MERCURIAL */

create table hg_revisions
(
hgrev_id int identity constraint pk_hg_revisions primary key nonclustered not null,
hgrev_revision int,
hgrev_bug int not null,
hgrev_repository nvarchar(400) not null,
hgrev_author nvarchar(100) not null,
hgrev_hg_date nvarchar(100) not null,
hgrev_btnet_date datetime not null,
hgrev_msg ntext not null
)

create clustered index hg_bug_index on hg_revisions (hgrev_bug)

create unique index hg_unique_revision on hg_revisions (hgrev_revision)

create table hg_affected_paths
(
hgap_id int identity constraint pk_hg_affected_paths primary key nonclustered not null,
hgap_hgrev_id int not null,
hgap_action nvarchar(8) not null,
hgap_path nvarchar(400) not null
)

create clustered index hgap_hgrev_index on hg_affected_paths (hgap_hgrev_id)



/* REPORTS */
create table reports
(
rp_id int identity constraint pk_reports primary key not null,
rp_desc nvarchar(200) not null,
rp_sql ntext not null,
rp_chart_type varchar(8) not null
)

create unique index unique_rp_desc on reports (rp_desc)

/* Some examples to get you started */

insert into reports (rp_desc, rp_sql, rp_chart_type)
values('Bugs by Status',
'select st_name [status], count(1) [count] '
+ char(10) + ' from bugs '
+ char(10) + ' inner join statuses on bg_status = st_id '
+ char(10) + ' group by st_name '
+ char(10) + ' order by st_name',
'pie')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values('Bugs by Priority',
'select pr_name [priority], count(1) [count] '
+ char(10) + ' from bugs '
+ char(10) + ' inner join priorities on bg_priority = pr_id '
+ char(10) + ' group by pr_name '
+ char(10) + ' order by pr_name',
'pie')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values('Bugs by Category',
'select ct_name [category], count(1) [count] '
+ char(10) + ' from bugs '
+ char(10) + ' inner join categories on bg_category = ct_id '
+ char(10) + ' group by ct_name '
+ char(10) + ' order by ct_name',
'pie')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values('Bugs by Month',
'select month(bg_reported_date) [month], count(1) [count] '
+ char(10) + ' from bugs '
+ char(10) + ' group by year(bg_reported_date), month(bg_reported_date) '
+ char(10) + ' order by year(bg_reported_date), month(bg_reported_date)',
'bar')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values('Bugs by Day of Year',
'select datepart(dy, bg_reported_date) [day of year], count(1) [count] '
+ char(10) + ' from bugs '
+ char(10) + ' group by datepart(dy, bg_reported_date), '
+ char(10) + ' datepart(dy,bg_reported_date) order by 1',
'line')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values('Bugs by User',
'select bg_reported_user, count(1) [r] '
+ char(10) + ' into #t '
+ char(10) + ' from bugs '
+ char(10) + ' group by bg_reported_user; '
+ char(10) + ' select bg_assigned_to_user, count(1) [a] '
+ char(10) + ' into #t2 '
+ char(10) + ' from bugs '
+ char(10) + ' group by bg_assigned_to_user; '
+ char(10) + ' select us_username, r [reported], a [assigned] '
+ char(10) + ' from users '
+ char(10) + ' left outer join #t on bg_reported_user = us_id '
+ char(10) + ' left outer join #t2 on bg_assigned_to_user = us_id '
+ char(10) + ' order by 1', 
'table')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values ('Hours by Org, Year, Month',
'select og_name [organization], '
+ char(10) + ' datepart(year,tsk_created_date) [year],  '
+ char(10) + ' datepart(month,tsk_created_date) [month], '
+ char(10) + ' convert(decimal(8,1),sum( '
+ char(10) + ' case when tsk_duration_units = ''minutes'' then tsk_actual_duration / 60.0 '
+ char(10) + ' when tsk_duration_units = ''days'' then tsk_actual_duration * 8.0  '
+ char(10) + ' else tsk_actual_duration * 1.0 end)) [total hours] '
+ char(10) + ' from bug_tasks '
+ char(10) + ' inner join bugs on tsk_bug = bg_id '
+ char(10) + ' inner join orgs on bg_org = og_id '
+ char(10) + ' where isnull(tsk_actual_duration,0) <> 0 '
+ char(10) + ' group by og_name,datepart(year,tsk_created_date), datepart(month,tsk_created_date) ',
'table')

insert into reports (rp_desc, rp_sql, rp_chart_type)
values ('Hours Remaining by Project',
'select pj_name [project], '
+ char(10) + ' convert(decimal(8,1),sum( '
+ char(10) + ' case  '
+ char(10) + ' when tsk_duration_units = ''minutes'' then  '
+ char(10) + ' tsk_planned_duration / 60.0 * .01 * (100 - isnull(tsk_percent_complete,0)) '
+ char(10) + ' when tsk_duration_units = ''days'' then ' 
+ char(10) + ' tsk_planned_duration * 8.0  * .01 * (100 - isnull(tsk_percent_complete,0)) '
+ char(10) + ' else tsk_planned_duration * .01 * (100 - isnull(tsk_percent_complete,0)) '
+ char(10) + ' end)) [total hours] '
+ char(10) + ' from bug_tasks '
+ char(10) + ' inner join bugs on tsk_bug = bg_id '
+ char(10) + ' inner join projects on bg_project = pj_id '
+ char(10) + ' where isnull(tsk_planned_duration,0) <> 0 '
+ char(10) + ' group by pj_name ',
'table')



/* QUERIES */

create table queries
(
qu_id int identity constraint pk_queries primary key not null,
qu_desc nvarchar(200) not null,
qu_sql ntext not null,
qu_default int null,
qu_user int null,
qu_org int null
)

create unique index unique_qu_desc on queries (qu_desc, qu_user, qu_org)


create table queued_notifications
(
qn_id int identity constraint pk_queued_notificatons primary key not null,
qn_date_created datetime not null,
qn_bug int not null,
qn_user int not null,
qn_status nvarchar(30) not null,
qn_retries int not null,
qn_last_exception nvarchar(1000) not null,
qn_to nvarchar(200) not null,
qn_from nvarchar(200) not null,
qn_subject nvarchar(400) not null,
qn_body ntext not null
)


create table dashboard_items
(
ds_id int identity constraint pk_dashboard_items primary key nonclustered not null,
ds_user int not null,
ds_report int not null,
ds_chart_type varchar(8) not null,
ds_col int not null,
ds_row int not null
)

create clustered index ds_user_index on dashboard_items (ds_user)

/*

The web pages that display the bugs expect the first two columns of the
queries to be the color or style of the row and the bug id.

Here are examples to get you started.

*/

insert into queries (qu_desc, qu_sql, qu_default) values (
'all bugs',
'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], '
+ char(10) + ' bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by],'
+ char(10) + ' bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to],'
+ char(10) + ' isnull(st_name,'''') [status], isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on]'
+ char(10) + ' from bugs '
+ char(10) + ' left outer join bug_user on bu_bug = bg_id and bu_user = $ME '
+ char(10) + ' left outer join users rpt on rpt.us_id = bg_reported_user'
+ char(10) + ' left outer join users asg on asg.us_id = bg_assigned_to_user'
+ char(10) + ' left outer join users lu on lu.us_id = bg_last_updated_user'
+ char(10) + ' left outer join projects on pj_id = bg_project'
+ char(10) + ' left outer join orgs on og_id = bg_org'
+ char(10) + ' left outer join categories on ct_id = bg_category'
+ char(10) + ' left outer join priorities on pr_id = bg_priority'
+ char(10) + ' left outer join statuses on st_id = bg_status'
+ char(10) + ' order by bg_id desc',
1)

insert into queries (qu_desc, qu_sql, qu_default) values (
'open bugs',
'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], '
+ char(10) + ' bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by],'
+ char(10) + ' bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to],'
+ char(10) + ' isnull(st_name,'''') [status], isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on]'
+ char(10) + ' from bugs '
+ char(10) + ' left outer join bug_user on bu_bug = bg_id and bu_user = $ME '
+ char(10) + ' left outer join users rpt on rpt.us_id = bg_reported_user'
+ char(10) + ' left outer join users asg on asg.us_id = bg_assigned_to_user'
+ char(10) + ' left outer join users lu on lu.us_id = bg_last_updated_user'
+ char(10) + ' left outer join projects on pj_id = bg_project'
+ char(10) + ' left outer join orgs on og_id = bg_org'
+ char(10) + ' left outer join categories on ct_id = bg_category'
+ char(10) + ' left outer join priorities on pr_id = bg_priority'
+ char(10) + ' left outer join statuses on st_id = bg_status'
+ char(10) + ' where bg_status <> 5 order by bg_id desc',
0)

insert into queries (qu_desc, qu_sql, qu_default) values (
'open bugs assigned to me',
'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], '
+ char(10) + ' bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by],'
+ char(10) + ' bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to],'
+ char(10) + ' isnull(st_name,'''') [status], isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on]'
+ char(10) + ' from bugs '
+ char(10) + ' left outer join bug_user on bu_bug = bg_id and bu_user = $ME '
+ char(10) + ' left outer join users rpt on rpt.us_id = bg_reported_user'
+ char(10) + ' left outer join users asg on asg.us_id = bg_assigned_to_user'
+ char(10) + ' left outer join users lu on lu.us_id = bg_last_updated_user'
+ char(10) + ' left outer join projects on pj_id = bg_project'
+ char(10) + ' left outer join orgs on og_id = bg_org'
+ char(10) + ' left outer join categories on ct_id = bg_category'
+ char(10) + ' left outer join priorities on pr_id = bg_priority'
+ char(10) + ' left outer join statuses on st_id = bg_status'
+ char(10) + ' where bg_status <> 5 and bg_assigned_to_user = $ME order by bg_id desc',
0)

insert into queries (qu_desc, qu_sql, qu_default) values (
'checked in bugs - for QA',
'select isnull(pr_background_color,''#ffffff''), bg_id [id], isnull(bu_flag,0) [$FLAG], '
+ char(10) + ' bg_short_desc [desc], isnull(pj_name,'''') [project], isnull(og_name,'''') [organization], isnull(ct_name,'''') [category], rpt.us_username [reported by],'
+ char(10) + ' bg_reported_date [reported on], isnull(pr_name,'''') [priority], isnull(asg.us_username,'''') [assigned to],'
+ char(10) + ' isnull(st_name,'''') [status], isnull(lu.us_username,'''') [last updated by], bg_last_updated_date [last updated on]'
+ char(10) + ' from bugs '
+ char(10) + ' left outer join bug_user on bu_bug = bg_id and bu_user = $ME '
+ char(10) + ' left outer join users rpt on rpt.us_id = bg_reported_user'
+ char(10) + ' left outer join users asg on asg.us_id = bg_assigned_to_user'
+ char(10) + ' left outer join users lu on lu.us_id = bg_last_updated_user'
+ char(10) + ' left outer join projects on pj_id = bg_project'
+ char(10) + ' left outer join orgs on og_id = bg_org'
+ char(10) + ' left outer join categories on ct_id = bg_category'
+ char(10) + ' left outer join priorities on pr_id = bg_priority'
+ char(10) + ' left outer join statuses on st_id = bg_status'
+ char(10) + ' where bg_status = 3 order by bg_id desc',
0)


insert into queries (qu_desc, qu_sql, qu_default) values (
'demo use of css classes',
'select isnull(pr_style + st_style,''datad''), bg_id [id], isnull(bu_flag,0) [$FLAG], bg_short_desc [desc], isnull(pr_name,'''') [priority], isnull(st_name,'''') [status]'
+ char(10) + ' from bugs '
+ char(10) + ' left outer join bug_user on bu_bug = bg_id and bu_user = $ME '
+ char(10) + ' left outer join priorities on pr_id = bg_priority '
+ char(10) + ' left outer join statuses on st_id = bg_status '
+ char(10) + ' order by bg_id desc',
0)

insert into queries (qu_desc, qu_sql, qu_default) values (
'demo last comment as column',
'select ''#ffffff'', bg_id [id], bg_short_desc [desc], ' 
+ char(10) + ' substring(bp_comment_search,1,40) [last comment], bp_date [last comment date]'
+ char(10) + ' from bugs'
+ char(10) + ' left outer join bug_posts on bg_id = bp_bug'
+ char(10) + ' and bp_type = ''comment''' 
+ char(10) + ' and bp_date in (select max(bp_date) from bug_posts where bp_bug = bg_id)'
+ char(10) + ' WhErE 1 = 1'
+ char(10) + ' order by bg_id desc',
0)


insert into queries (qu_desc, qu_sql, qu_default) values (
'days in status',
'select case '
+ char(10) + ' when datediff(d, isnull(bp_date,bg_reported_date), getdate()) > 90 then ''#ff9999'' '
+ char(10) + ' when datediff(d, isnull(bp_date,bg_reported_date), getdate()) > 30 then ''#ffcccc'' '
+ char(10) + ' when datediff(d, isnull(bp_date,bg_reported_date), getdate()) > 7 then ''#ffdddd''  '
+ char(10) + ' else ''#ffffff'' end, '
+ char(10) + ' bg_id [id], bg_short_desc [desc], '
+ char(10) + ' datediff(d, isnull(bp_date,bg_reported_date), getdate()) [days in status],'
+ char(10) + ' st_name [status], '
+ char(10) + ' isnull(bp_comment,'''') [last status change], isnull(bp_date,bg_reported_date) [status date]'
+ char(10) + ' from bugs'
+ char(10) + ' inner join statuses on bg_status = st_id'
+ char(10) + ' left outer join bug_posts on bg_id = bp_bug'
+ char(10) + ' and bp_type = ''update'' '
+ char(10) + ' and bp_comment like ''changed status from%'' '
+ char(10) + ' and bp_date in (select max(bp_date) from bug_posts where bp_bug = bg_id)'
+ char(10) + ' WhErE 1 = 1 '
+ char(10) + ' order by 4 desc ',
0)


insert into queries (qu_desc, qu_sql, qu_default) values (
'bugs with attachments',
'select bp_bug, sum(bp_size) bytes '
+ char(10) + ' into #t '
+ char(10) + ' from bug_posts '
+ char(10) + ' where bp_type = ''file'' '
+ char(10) + ' group by bp_bug '
+ char(10) + ' select ''#ffffff'', bg_id [id], bg_short_desc [desc], '
+ char(10) + ' bytes, rpt.us_username [reported by] ' 
+ char(10) + ' from bugs '
+ char(10) + ' inner join #t on bp_bug = bg_id '
+ char(10) + ' left outer join users rpt on rpt.us_id = bg_reported_user '
+ char(10) + ' WhErE 1 = 1 '
+ char(10) + ' order by bytes desc ' 
+ char(10) + ' drop table #t ',
0)

insert into queries (qu_desc, qu_sql, qu_default) values (
'bugs with related bugs',
'select ''#ffffff'', bg_id [id], bg_short_desc [desc], '
+ char(10) + ' isnull(st_name,'''') [status], '
+ char(10) + ' count(*) [number of related bugs] '
+ char(10) + ' from bugs '
+ char(10) + ' inner join bug_relationships on re_bug1 = bg_id '
+ char(10) + ' inner join statuses on bg_status = st_id '
+ char(10) + ' /*ENDWHR*/ '
+ char(10) + ' group by bg_id, bg_short_desc, isnull(st_name,'''') '
+ char(10) + ' order by bg_id desc ',
0)

insert into queries (qu_desc, qu_sql, qu_default) values (
'demo votes feature',
'select ''#ffffff'', bg_id [id], '
+ char(10) + ' (isnull(vote_total,0) * 10000) + isnull(bu_vote,0) [$VOTE], '
+ char(10) + ' bg_short_desc [desc], isnull(st_name,'''') [status] '
+ char(10) + ' from bugs '
+ char(10) + ' left outer join bug_user on bu_bug = bg_id and bu_user = $ME '
+ char(10) + ' left outer join votes_view on vote_bug = bg_id '
+ char(10) + ' left outer join statuses on st_id = bg_status '
+ char(10) + ' order by 3 desc ',
0)



2015-11-12 21:47:36 http://www.learncodinganywhere.com/bugtracker/query.aspx elapsed milliseconds:1952
2015-11-12 21:48:12 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx elapsed milliseconds:0041
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
update users set us_password = N'D1FFA62FF23503D2437F9501DEADC4AF', us_salt = 84337 where us_id = 1
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select us_id from users where us_username = N'admin'
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx elapsed milliseconds:0001
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx guid=5f66f107-c94b-4458-a99f-58aad05b80b7
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
insert into sessions (se_id, se_user) values('5f66f107-c94b-4458-a99f-58aad05b80b7', 1)
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/default.aspx AppPath:/bugtracker
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0104
2015-11-12 21:48:17 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0328
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0045
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0029
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 21:48:18 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0140
2015-11-12 21:50:54 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:50:54 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 21:50:54 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 21:50:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0035
2015-11-12 21:50:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 21:50:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0083
2015-11-12 21:50:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 21:50:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0028
2015-11-12 21:51:03 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:03 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0000
2015-11-12 21:51:03 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 21:51:06 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:06 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0000
2015-11-12 21:51:06 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 21:51:06 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0053
2015-11-12 21:51:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0000
2015-11-12 21:51:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 4
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 4

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 4
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 4
2015-11-12 21:51:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0012
2015-11-12 21:51:14 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:14 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0002
2015-11-12 21:51:14 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 21:51:14 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0052
2015-11-12 21:51:20 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:20 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0003
2015-11-12 21:51:20 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 21:51:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0000
2015-11-12 21:51:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 21:51:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0005
2015-11-12 21:51:26 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:51:26 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 21:51:26 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=
select *,isnull(og_domain,'') og_domain2 from orgs where og_id = 4
2015-11-12 21:51:26 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0002
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0001
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

update orgs set
	og_name = N'Credit Accelerator',
	og_domain = N'www.creditacclerator.com',
	og_active = 1,
	og_non_admins_can_use = 0,
	og_external_user = 1,
	og_can_edit_sql = 0,
	og_can_delete_bug = 0,
	og_can_edit_and_delete_posts = 0,
	og_can_merge_bugs = 0,
	og_can_mass_edit_bugs = 0,
	og_can_use_reports = 0,
	og_can_edit_reports = 0,
	og_can_be_assigned_to = 0,
	og_can_view_tasks = 0,
	og_can_edit_tasks = 0,
	og_can_search = 1,
	og_can_only_see_own_reported = 0,
	og_can_assign_to_internal_users = 0,
	og_other_orgs_permission_level = 0,
	og_project_field_permission_level = 2,
	og_org_field_permission_level = 2,
	og_category_field_permission_level = 2,
	og_tags_field_permission_level = 2,
	og_priority_field_permission_level = 2,
	og_status_field_permission_level = 2,
	og_assigned_to_field_permission_level = 2,
	og_udf_field_permission_level = 2
	
	where og_id = 4
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 21:52:55 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 21:53:01 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:53:01 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0000
2015-11-12 21:53:01 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=
declare @cnt int
			select @cnt = count(1) from users where us_org = 5;
			select @cnt = @cnt + count(1) from queries where qu_org = 5;
			select @cnt = @cnt + count(1) from bugs where bg_org = 5;
			select og_name, @cnt [cnt] from orgs where og_id = 5
2015-11-12 21:53:01 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0004
2015-11-12 21:53:08 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:53:08 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=1 elapsed milliseconds:0002
2015-11-12 21:53:08 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=1 sql=
declare @cnt int
			select @cnt = count(1) from users where us_org = 1;
			select @cnt = @cnt + count(1) from queries where qu_org = 1;
			select @cnt = @cnt + count(1) from bugs where bg_org = 1;
			select og_name, @cnt [cnt] from orgs where og_id = 1
2015-11-12 21:53:08 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=1 elapsed milliseconds:0004
2015-11-12 21:53:15 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 21:53:15 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 21:53:15 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx elapsed milliseconds:0001
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx sql=
declare @org int
			select @org = us_org from users where us_id = 1

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 1
			or isnull(qu_org,0) = @org
			order by qu_desc
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx elapsed milliseconds:0004
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx sql=
select pj_id, pj_name, isnull(pu_auto_subscribe,0) [pu_auto_subscribe]
			from projects
			left outer join project_user_xref on pj_id = pu_project and 1 = pu_user
			where isnull(pu_permission_level,2) <> 0
			order by pj_name
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx elapsed milliseconds:0004
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx sql=
select
			us_username [username],
			isnull(us_firstname,'') [firstname],
			isnull(us_lastname,'') [lastname],
			isnull(us_bugs_per_page,10) [us_bugs_per_page],
			us_use_fckeditor,
			us_enable_bug_list_popups,
			isnull(us_email,'') [email],
			us_enable_notifications,
			us_send_notifications_to_self,
            us_reported_notifications,
            us_assigned_notifications,
            us_subscribed_notifications,
			us_auto_subscribe,
			us_auto_subscribe_own_bugs,
			us_auto_subscribe_reported_bugs,
			us_default_query,
			isnull(us_signature,'') [signature]
			from users
			where us_id = 1
2015-11-12 22:02:07 http://www.learncodinganywhere.com/bugtracker/edit_self.aspx elapsed milliseconds:0002
2015-11-12 22:02:18 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:02:18 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:02:18 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:04:22 http://www.learncodinganywhere.com/bugtracker/edit_custom_html.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:04:22 http://www.learncodinganywhere.com/bugtracker/edit_custom_html.aspx elapsed milliseconds:0001
2015-11-12 22:07:40  caught exception in util.set_context:Request is not available in this context
2015-11-12 22:07:40  threadproc_votes
2015-11-12 22:07:40  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2015-11-12 22:07:40  started creating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:07:40  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2015-11-12 22:07:40  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2015-11-12 22:07:40  elapsed milliseconds:0011
2015-11-12 22:07:40 http://www.learncodinganywhere.com/bugtracker/reports.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:07:40 http://www.learncodinganywhere.com/bugtracker/reports.aspx elapsed milliseconds:0000
2015-11-12 22:07:40 http://www.learncodinganywhere.com/bugtracker/reports.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2015-11-12 22:07:40  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:07:40 http://www.learncodinganywhere.com/bugtracker/reports.aspx elapsed milliseconds:0002
2015-11-12 22:07:40 http://www.learncodinganywhere.com/bugtracker/reports.aspx sql=

select
rp_desc [report],
case
	when rp_chart_type = 'pie' then
		'<a target=''_blank'' href=''view_report.aspx?view=chart&id=' + convert(varchar, rp_id) + '''>pie</a>'
	when rp_chart_type = 'line' then
		'<a target=''_blank'' href=''view_report.aspx?view=chart&id=' + convert(varchar, rp_id) + '''>line</a>'
	when rp_chart_type = 'bar' then
		'<a target=''_blank'' href=''view_report.aspx?view=chart&id=' + convert(varchar, rp_id) + '''>bar</a>'
	else
		'&nbsp;' end [view<br>chart],
'<a target=''_blank'' href=''view_report.aspx?view=data&id=' + convert(varchar, rp_id) + '''>data</a>' [view<br>data]
, '<a href=''edit_report.aspx?id=' + convert(varchar, rp_id) + '''>edit</a>' [edit], '<a href=''delete_report.aspx?id=' + convert(varchar, rp_id) + '''>delete</a>' [delete] 
from reports order by rp_desc
2015-11-12 22:07:40 http://www.learncodinganywhere.com/bugtracker/reports.aspx elapsed milliseconds:0003
2015-11-12 22:07:41  elapsed milliseconds:0166
2015-11-12 22:07:41  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2015-11-12 22:07:41  elapsed milliseconds:0001
2015-11-12 22:07:41  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2015-11-12 22:07:41  elapsed milliseconds:0016
2015-11-12 22:07:41  done creating Lucene index
2015-11-12 22:07:43 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:07:43 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:07:43 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:07:47 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:07:47 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0002
2015-11-12 22:07:47 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:07:47 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0018
2015-11-12 22:07:57 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:07:57 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx elapsed milliseconds:0000
2015-11-12 22:07:57 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx sql=
select us_id, us_username from users order by us_username
2015-11-12 22:07:57 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx elapsed milliseconds:0001
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx elapsed milliseconds:0000
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx sql=
insert into projects
			(pj_name, pj_active, pj_default_user, pj_default, pj_auto_assign_default_user, pj_auto_subscribe_default_user,
			pj_enable_pop3,
			pj_pop3_username,
			pj_pop3_password,
			pj_pop3_email_from,
			pj_description,
			pj_enable_custom_dropdown1,
			pj_enable_custom_dropdown2,
			pj_enable_custom_dropdown3,
			pj_custom_dropdown_label1,
			pj_custom_dropdown_label2,
			pj_custom_dropdown_label3,
			pj_custom_dropdown_values1,
			pj_custom_dropdown_values2,
			pj_custom_dropdown_values3)
			values (N'Credit Accelerator phase I', 1, 0, 0, 0, 0,
			0, N'',N'',N'',
			N'', 
			0,0,0,
			N'',N'',N'',
			N'',N'',N'')
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx elapsed milliseconds:0000
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:08:39 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx elapsed milliseconds:0000
2015-11-12 22:09:02 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:02 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0002
2015-11-12 22:09:02 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=
select us_id, us_username from users order by us_username
2015-11-12 22:09:02 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0000
2015-11-12 22:09:02 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=
select
			pj_name,
			pj_active,
			isnull(pj_default_user,0) [pj_default_user],
			pj_default,
			isnull(pj_auto_assign_default_user,0) [pj_auto_assign_default_user],
			isnull(pj_auto_subscribe_default_user,0) [pj_auto_subscribe_default_user],
			isnull(pj_enable_pop3,0) [pj_enable_pop3],
			isnull(pj_pop3_username,'') [pj_pop3_username],
			isnull(pj_pop3_email_from,'') [pj_pop3_email_from],
			isnull(pj_description,'') [pj_description],
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects
			where pj_id = 3
2015-11-12 22:09:02 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0005
2015-11-12 22:09:11 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:11 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0003
2015-11-12 22:09:11 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:09:11 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 22:09:13 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:13 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0005
2015-11-12 22:09:13 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:09:18 http://www.learncodinganywhere.com/bugtracker/categories.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:18 http://www.learncodinganywhere.com/bugtracker/categories.aspx elapsed milliseconds:0000
2015-11-12 22:09:18 http://www.learncodinganywhere.com/bugtracker/categories.aspx sql=
select
		ct_id [id],
		ct_name [category],
		ct_sort_seq [sort seq],
		case when ct_default = 1 then 'Y' else 'N' end [default],
		ct_id [hidden]
		from categories order by ct_name
2015-11-12 22:09:18 http://www.learncodinganywhere.com/bugtracker/categories.aspx elapsed milliseconds:0002
2015-11-12 22:09:26 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:26 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0000
2015-11-12 22:09:26 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:09:29 http://www.learncodinganywhere.com/bugtracker/priorities.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:29 http://www.learncodinganywhere.com/bugtracker/priorities.aspx elapsed milliseconds:0001
2015-11-12 22:09:29 http://www.learncodinganywhere.com/bugtracker/priorities.aspx sql=
select pr_id [id],
		pr_name [description],
		pr_sort_seq [sort seq],
		'<div style=''background:' + pr_background_color + ';''>' + pr_background_color + '</div>' [background<br>color],
		pr_style [css<br>class],
		case when pr_default = 1 then 'Y' else 'N' end [default],
		pr_id [hidden] from priorities
2015-11-12 22:09:29 http://www.learncodinganywhere.com/bugtracker/priorities.aspx elapsed milliseconds:0002
2015-11-12 22:09:34 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:34 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0003
2015-11-12 22:09:34 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:09:37 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:37 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0000
2015-11-12 22:09:37 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:09:37 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0021
2015-11-12 22:09:49 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:09:49 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:09:49 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 4
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 4

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 4
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 4
2015-11-12 22:09:49 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=
select count(1)
				from users where us_username = N'erikg' and us_id <> 4
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

update users set
us_username = N'erikg',
us_firstname = N'Erik',
us_lastname = N'Gross',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'erik.d.gross@gmail.com',
us_active = 1,
us_admin = 1,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 1,
us_org = 4,
us_signature = N'',
us_forced_project = 0
where us_id = 4
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=
update users set us_password = N'AEAB0389F5CF8335A3F864CFCA72F6FA', us_salt = 74318 where us_id = 4
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 4;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 4
			and pu_project in (3,2,1);
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:11:04 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0022
2015-11-12 22:11:31 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:11:31 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:11:31 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 1
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 1

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 1
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 1
2015-11-12 22:11:31 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 elapsed milliseconds:0012
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=
select count(1)
				from users where us_username = N'admin' and us_id <> 1
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

update users set
us_username = N'admin',
us_firstname = N'System',
us_lastname = N'Administrator',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'',
us_active = 1,
us_admin = 1,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 1,
us_org = 1,
us_signature = N'',
us_forced_project = 0
where us_id = 1
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=
update users set us_password = N'E658266C6BA1AA9BFBA1EF35D49C59C0', us_salt = 80501 where us_id = 1
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 1;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 1
			and pu_project in (3,2,1);
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:12:17 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=1 elapsed milliseconds:0033
2015-11-12 22:12:20 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:20 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0005
2015-11-12 22:12:20 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:12:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0000
2015-11-12 22:12:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:12:22 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0000
2015-11-12 22:12:25 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:25 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:12:25 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=
select *,isnull(og_domain,'') og_domain2 from orgs where og_id = 1
2015-11-12 22:12:25 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0002
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

update orgs set
	og_name = N'Prosper IT Consulting',
	og_domain = N'www.prosperitconsuling.com',
	og_active = 1,
	og_non_admins_can_use = 0,
	og_external_user = 0,
	og_can_edit_sql = 0,
	og_can_delete_bug = 0,
	og_can_edit_and_delete_posts = 0,
	og_can_merge_bugs = 0,
	og_can_mass_edit_bugs = 0,
	og_can_use_reports = 0,
	og_can_edit_reports = 0,
	og_can_be_assigned_to = 1,
	og_can_view_tasks = 0,
	og_can_edit_tasks = 0,
	og_can_search = 1,
	og_can_only_see_own_reported = 0,
	og_can_assign_to_internal_users = 0,
	og_other_orgs_permission_level = 2,
	og_project_field_permission_level = 2,
	og_org_field_permission_level = 2,
	og_category_field_permission_level = 2,
	og_tags_field_permission_level = 2,
	og_priority_field_permission_level = 2,
	og_status_field_permission_level = 2,
	og_assigned_to_field_permission_level = 2,
	og_udf_field_permission_level = 2
	
	where og_id = 1
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:12:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:13:02 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:02 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:13:02 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:13:05 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:05 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0001
2015-11-12 22:13:05 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:13:05 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0025
2015-11-12 22:13:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:13:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 3
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 3

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 3
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 3
2015-11-12 22:13:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0012
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0002
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=
select count(1)
				from users where us_username = N'tester' and us_id <> 3
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

update users set
us_username = N'tester',
us_firstname = N'Norman',
us_lastname = N'Cash',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'',
us_active = 1,
us_admin = 0,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 4,
us_org = 4,
us_signature = N'',
us_forced_project = 0
where us_id = 3
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 3;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 3
			and pu_project in (3,2,1);
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0002
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:13:26 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0055
2015-11-12 22:13:38 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:38 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:13:38 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:13:40 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:40 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0001
2015-11-12 22:13:40 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:13:40 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0000
2015-11-12 22:13:49 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:49 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:13:49 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:13:51 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:52 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0002
2015-11-12 22:13:52 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:13:52 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0024
2015-11-12 22:13:57 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:13:57 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:13:57 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 3
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 3

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 3
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 3
2015-11-12 22:13:57 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0002
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=
select count(1)
				from users where us_username = N'devinr' and us_id <> 3
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

update users set
us_username = N'devinr',
us_firstname = N'Devin',
us_lastname = N'Rice',
us_bugs_per_page = N'10',
us_use_fckeditor = 1,
us_enable_bug_list_popups = 1,
us_email = N'devin@bdiwebsite.com',
us_active = 1,
us_admin = 0,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 4,
us_org = 4,
us_signature = N'',
us_forced_project = 0
where us_id = 3
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=
update users set us_password = N'76C0EF9C113E454D699814971BEB552E', us_salt = 91390 where us_id = 3
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 3;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 3
			and pu_project in (3,2,1);
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0000
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:19:52 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0026
2015-11-12 22:19:59 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:19:59 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 elapsed milliseconds:0001
2015-11-12 22:19:59 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 5
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 5

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 5
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 5
2015-11-12 22:19:59 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 elapsed milliseconds:0010
2015-11-12 22:28:56 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:28:56 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 elapsed milliseconds:0001
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 elapsed milliseconds:0001
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=
select count(1)
				from users where us_username = N'brets' and us_id <> 5
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

update users set
us_username = N'brets',
us_firstname = N'Bret',
us_lastname = N'Saxon',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'bret@transactionalmarketing.com',
us_active = 1,
us_admin = 0,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 1,
us_org = 4,
us_signature = N'',
us_forced_project = 0
where us_id = 5
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=
update users set us_password = N'9F0E9B5AC2B9F90B82DF064281517DE4', us_salt = 88086 where us_id = 5
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 5;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 5
			and pu_project in (3,2,1);
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 elapsed milliseconds:0000
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:29:12 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=5 elapsed milliseconds:0030
2015-11-12 22:29:20 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:29:20 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 elapsed milliseconds:0003
2015-11-12 22:29:20 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 2
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 2

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 2
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 2
2015-11-12 22:29:20 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 elapsed milliseconds:0017
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=
select count(1)
				from users where us_username = N'brandonh' and us_id <> 2
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

update users set
us_username = N'brandonh',
us_firstname = N'Brandon',
us_lastname = N'Hilde',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'bjames.12999@gmail.com',
us_active = 1,
us_admin = 0,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 3,
us_org = 4,
us_signature = N'',
us_forced_project = 0
where us_id = 2
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=
update users set us_password = N'A8998F70F426D17A4E87AA9241A4D911', us_salt = 25917 where us_id = 2
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 2;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 2
			and pu_project in (3,2,1);
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:31:11 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=2 elapsed milliseconds:0023
2015-11-12 22:31:48 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:31:48 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx elapsed milliseconds:0001
2015-11-12 22:31:48 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 0
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 0

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 0
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
2015-11-12 22:31:48 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx elapsed milliseconds:0009
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx elapsed milliseconds:0001
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=
select count(1) from users where us_username = N'cliffc'
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

insert into users
(us_username, us_password,
us_firstname, us_lastname,
us_bugs_per_page,
us_use_fckeditor,
us_enable_bug_list_popups,
us_email,
us_active, us_admin,
us_enable_notifications,
us_send_notifications_to_self,
us_reported_notifications,
us_assigned_notifications,
us_subscribed_notifications,
us_auto_subscribe,
us_auto_subscribe_own_bugs,
us_auto_subscribe_reported_bugs,
us_default_query,
us_org,
us_signature,
us_forced_project,
us_created_user)

values (
N'cliffc', N'1631010480', N'Cliff', N'Cannon',
10, 0, 1, N'cliffordcan@gmail.com',
1, 0, 1,  0,
4, 4, 4, 0,
1, 1, 1, 4, N'',
0,
1
);

select scope_identity()
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=
update users set us_password = N'3FC8FBB70BB043F8049454B1548C72D0', us_salt = 95920 where us_id = 10
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 10;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 10
			and pu_project in (3,2,1);
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx elapsed milliseconds:0000
2015-11-12 22:32:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:32:47 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx elapsed milliseconds:0030
2015-11-12 22:33:19 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:33:19 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:33:19 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 4
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 4

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 4
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 4
2015-11-12 22:33:19 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:33:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:33:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:33:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=
select count(1)
				from users where us_username = N'erikg' and us_id <> 4
2015-11-12 22:33:46 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

update users set
us_username = N'erikg',
us_firstname = N'Erik',
us_lastname = N'Gross',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'erik.d.gross@gmail.com',
us_active = 1,
us_admin = 1,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 1,
us_org = 4,
us_signature = N'',
us_forced_project = 0
where us_id = 4
2015-11-12 22:33:47 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

			insert into project_user_xref (pu_project, pu_user, pu_auto_subscribe)
			select pj_id, 4, 0
			from projects
			where pj_id in (3)
			and pj_id not in (select pu_project from project_user_xref where pu_user = 4);
		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 4;
				update project_user_xref
				set pu_admin = 1
				where pu_user = 4
				and pu_project in (3);
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 4
			and pu_project in (3,2,1);
2015-11-12 22:33:47 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:33:47 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:33:47 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:33:47 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0024
2015-11-12 22:34:02 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:34:02 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:34:02 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:34:10 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0002
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:34:13 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0003
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0012
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2015-11-12 22:35:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0002
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0091
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Create ''Customer'' user role', N'', 1,  1, getdate(), getdate(),
					3, 4,
					3, 1, 1, 0, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 22:35:52 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 1

delete from bug_subscriptions
where bs_bug = 1
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 1
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 1
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 1
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 1
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, us_id
from users
inner join bugs on bg_id = 1
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 1)
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 1
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:35:53  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:35:53  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:35:53  elapsed milliseconds:0000
2015-11-12 22:35:53  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 1
2015-11-12 22:35:53  elapsed milliseconds:0001
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0123
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:35:53  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 1
2015-11-12 22:35:53  elapsed milliseconds:0003
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0107
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2015-11-12 22:35:53  done updating Lucene index
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:35:53 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0026
2015-11-12 22:35:57 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:35:57 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:35:57 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:36:00 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:00 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 22:36:00 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:36:00 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 22:36:04 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:04 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0001
2015-11-12 22:36:04 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=
select us_id, us_username from users order by us_username
2015-11-12 22:36:04 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0000
2015-11-12 22:36:04 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=
select
			pj_name,
			pj_active,
			isnull(pj_default_user,0) [pj_default_user],
			pj_default,
			isnull(pj_auto_assign_default_user,0) [pj_auto_assign_default_user],
			isnull(pj_auto_subscribe_default_user,0) [pj_auto_subscribe_default_user],
			isnull(pj_enable_pop3,0) [pj_enable_pop3],
			isnull(pj_pop3_username,'') [pj_pop3_username],
			isnull(pj_pop3_email_from,'') [pj_pop3_email_from],
			isnull(pj_description,'') [pj_description],
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects
			where pj_id = 3
2015-11-12 22:36:04 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0000
2015-11-12 22:36:09 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?id=3&label=Credit+Accelerator+phase+I sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:09 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?id=3&label=Credit+Accelerator+phase+I elapsed milliseconds:0001
2015-11-12 22:36:09 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?id=3&label=Credit+Accelerator+phase+I sql=
Select us_username, us_id, isnull(pu_permission_level,2) [pu_permission_level]
			from users
			left outer join project_user_xref on pu_user = us_id
			and pu_project = 3
			order by us_username;
			select pj_name from projects where pj_id = 3;
2015-11-12 22:36:09 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?id=3&label=Credit+Accelerator+phase+I elapsed milliseconds:0006
2015-11-12 22:36:19 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:19 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:36:19 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?id=3 sql=
select us_id, us_username from users order by us_username
2015-11-12 22:36:19 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?id=3 elapsed milliseconds:0000
2015-11-12 22:36:19 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?id=3 sql=
select
			pj_name,
			pj_active,
			isnull(pj_default_user,0) [pj_default_user],
			pj_default,
			isnull(pj_auto_assign_default_user,0) [pj_auto_assign_default_user],
			isnull(pj_auto_subscribe_default_user,0) [pj_auto_subscribe_default_user],
			isnull(pj_enable_pop3,0) [pj_enable_pop3],
			isnull(pj_pop3_username,'') [pj_pop3_username],
			isnull(pj_pop3_email_from,'') [pj_pop3_email_from],
			isnull(pj_description,'') [pj_description],
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects
			where pj_id = 3
2015-11-12 22:36:19 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?id=3 elapsed milliseconds:0000
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0006
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:36:27 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0026
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0003
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0010
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:36:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:36:41 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:41 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0003
2015-11-12 22:36:41 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:36:46 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:46 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 22:36:46 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:36:46 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 22:36:57 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:36:57 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 elapsed milliseconds:0002
2015-11-12 22:36:57 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 sql=
Select us_username, us_id, isnull(pu_permission_level,2) [pu_permission_level]
			from users
			left outer join project_user_xref on pu_user = us_id
			and pu_project = 3
			order by us_username;
			select pj_name from projects where pj_id = 3;
2015-11-12 22:36:57 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 elapsed milliseconds:0000
2015-11-12 22:37:23 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:23 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 elapsed milliseconds:0045
2015-11-12 22:37:23 http://www.learncodinganywhere.com/bugtracker/edit_user_permissions2.aspx?projects=y&id=3 sql=
 if exists (select * from project_user_xref where pu_user = 1 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 1 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (1, 3, 2);  if exists (select * from project_user_xref where pu_user = 2 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 2 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (2, 3, 2);  if exists (select * from project_user_xref where pu_user = 5 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 5 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (5, 3, 2);  if exists (select * from project_user_xref where pu_user = 10 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 10 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (10, 3, 2);  if exists (select * from project_user_xref where pu_user = 3 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 3 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (3, 3, 2);  if exists (select * from project_user_xref where pu_user = 6 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 6 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (6, 3, 2);  if exists (select * from project_user_xref where pu_user = 4 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 2
		            where pu_user = 4 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (4, 3, 2);  if exists (select * from project_user_xref where pu_user = 9 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 1
		            where pu_user = 9 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (9, 3, 1);  if exists (select * from project_user_xref where pu_user = 8 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 3
		            where pu_user = 8 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (8, 3, 3);  if exists (select * from project_user_xref where pu_user = 7 and pu_project = 3)
		            update project_user_xref set pu_permission_level = 1
		            where pu_user = 7 and pu_project = 3
		         else
		            insert into project_user_xref (pu_user, pu_project, pu_permission_level)
		            values (7, 3, 1); 
2015-11-12 22:37:26 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:26 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 22:37:26 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:37:26 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 22:37:30 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:30 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0001
2015-11-12 22:37:30 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=
select us_id, us_username from users order by us_username
2015-11-12 22:37:30 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0001
2015-11-12 22:37:30 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 sql=
select
			pj_name,
			pj_active,
			isnull(pj_default_user,0) [pj_default_user],
			pj_default,
			isnull(pj_auto_assign_default_user,0) [pj_auto_assign_default_user],
			isnull(pj_auto_subscribe_default_user,0) [pj_auto_subscribe_default_user],
			isnull(pj_enable_pop3,0) [pj_enable_pop3],
			isnull(pj_pop3_username,'') [pj_pop3_username],
			isnull(pj_pop3_email_from,'') [pj_pop3_email_from],
			isnull(pj_description,'') [pj_description],
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects
			where pj_id = 3
2015-11-12 22:37:30 http://www.learncodinganywhere.com/bugtracker/edit_project.aspx?&id=3 elapsed milliseconds:0000
2015-11-12 22:37:38 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:38 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:37:38 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:37:41 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:41 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0002
2015-11-12 22:37:41 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:37:41 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0059
2015-11-12 22:37:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0009
2015-11-12 22:37:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 4
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 4

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 4
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 4
2015-11-12 22:37:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0005
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:37:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0002
2015-11-12 22:37:59 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:37:59 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 22:37:59 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:37:59 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 22:37:59 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:37:59 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0002
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:38:04 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:40:55 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:40:55 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0005
2015-11-12 22:40:55 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:42:04  caught exception in util.set_context:Request is not available in this context
2015-11-12 22:42:04  threadproc_votes
2015-11-12 22:42:04  sql=

if exists (select * from dbo.sysobjects where id = object_id(N'[votes_view]'))
drop view [votes_view]
2015-11-12 22:42:04  started creating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:42:04  sql=

create view votes_view as
select bu_bug as vote_bug, sum(bu_vote) as vote_total
from bug_user
group by bu_bug
having sum(bu_vote) > 0
2015-11-12 22:42:04  sql=

select bu_bug, count(1)
from bug_user 
where bu_vote = 1
group by bu_bug
2015-11-12 22:42:04  elapsed milliseconds:0000
2015-11-12 22:42:04 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:04 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 22:42:04 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* custom columns */ select sc.name, st.[name] [datatype], 
case when st.[name] = 'nvarchar' or st.[name] = 'nchar' then sc.length/2 else sc.length end as [length], 
sc.xprec, sc.xscale, sc.isnullable,
mm.text [default value], 
dflts.name [default name], 
isnull(ccm_dropdown_type,'') [dropdown type],
isnull(ccm_dropdown_vals,'') [vals],
isnull(ccm_sort_seq, sc.colorder) [column order],
sc.colorder
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
left outer join syscomments mm on sc.cdefault = mm.id
left outer join custom_col_metadata on ccm_colorder = sc.colorder
left outer join sysobjects dflts on dflts.id = mm.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
order by sc.id, isnull(ccm_sort_seq,sc.colorder)
2015-11-12 22:42:04 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 22:42:04 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:42:04 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 22:42:04  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:42:04  elapsed milliseconds:0001
2015-11-12 22:42:04  sql=

select bg_id, 	

isnull(bg_tags,'') bg_tags,
bg_short_desc
from bugs
2015-11-12 22:42:04  elapsed milliseconds:0000
2015-11-12 22:42:04  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
2015-11-12 22:42:04  elapsed milliseconds:0000
2015-11-12 22:42:04  done creating Lucene index
2015-11-12 22:42:07 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:07 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0002
2015-11-12 22:42:07 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=
declare @cnt int
			select @cnt = count(1) from bugs where bg_project = 3
			select pj_name, @cnt [cnt] from projects where pj_id = 3
2015-11-12 22:42:07 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0003
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:42:12 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 3
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select isnull(pj_default_user,0)
					from projects
					where pj_id = 3
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select
			isnull(pj_enable_custom_dropdown1,0) [pj_enable_custom_dropdown1],
			isnull(pj_enable_custom_dropdown2,0) [pj_enable_custom_dropdown2],
			isnull(pj_enable_custom_dropdown3,0) [pj_enable_custom_dropdown3],
			isnull(pj_custom_dropdown_label1,'') [pj_custom_dropdown_label1],
			isnull(pj_custom_dropdown_label2,'') [pj_custom_dropdown_label2],
			isnull(pj_custom_dropdown_label3,'') [pj_custom_dropdown_label3],
			isnull(pj_custom_dropdown_values1,'') [pj_custom_dropdown_values1],
			isnull(pj_custom_dropdown_values2,'') [pj_custom_dropdown_values2],
			isnull(pj_custom_dropdown_values3,'') [pj_custom_dropdown_values3]
			from projects where pj_id = 3
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:22 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:22 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0002
2015-11-12 22:42:22 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:42:22 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0004
2015-11-12 22:42:22 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:42:22 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 1
		if @last_updated > '20151112 22:42:14:820'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 22:42:14:820'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Create ''Customer'' user role',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 0,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 1
		end
		select @now
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 1

delete from bug_subscriptions
where bs_bug = 1
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 1
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 1
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 1
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 1
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, us_id
from users
inner join bugs on bg_id = 1
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 1)
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select count(1) from bug_subscriptions where bs_bug = 1 and bs_user = 1
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(1, 1, getdate(), N'changed project from "Credit Accelerator phase I" to "[no project]"', 'update')
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (4 <= us_reported_notifications and bg_reported_user = bs_user)
or (4 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (4 <= us_assigned_notifications and 0 = bs_user)
or (4 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 1
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:42:27  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0018
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:42:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:42:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0062
2015-11-12 22:42:28  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:42:28  elapsed milliseconds:0000
2015-11-12 22:42:28  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 1
2015-11-12 22:42:28  elapsed milliseconds:0000
2015-11-12 22:42:28  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 1
2015-11-12 22:42:28  elapsed milliseconds:0013
2015-11-12 22:42:28  done updating Lucene index
2015-11-12 22:42:32 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:32 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:42:32 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:42:35 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:35 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 22:42:35 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:42:35 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 22:42:38 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:38 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:42:38 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=
declare @cnt int
			select @cnt = count(1) from bugs where bg_project = 3
			select pj_name, @cnt [cnt] from projects where pj_id = 3
2015-11-12 22:42:38 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0003
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=
delete projects where pj_id = 3
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 22:42:39 http://www.learncodinganywhere.com/bugtracker/delete_project.aspx?id=3 elapsed milliseconds:0000
2015-11-12 22:42:45 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:45 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:42:45 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:42:48 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:48 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0001
2015-11-12 22:42:48 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:42:48 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0000
2015-11-12 22:42:52 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:52 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0004
2015-11-12 22:42:52 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=
declare @cnt int
			select @cnt = count(1) from users where us_org = 5;
			select @cnt = @cnt + count(1) from queries where qu_org = 5;
			select @cnt = @cnt + count(1) from bugs where bg_org = 5;
			select og_name, @cnt [cnt] from orgs where og_id = 5
2015-11-12 22:42:52 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0000
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0001
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=
delete orgs where og_id = 5
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0000
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:42:54 http://www.learncodinganywhere.com/bugtracker/delete_org.aspx?id=5 elapsed milliseconds:0000
2015-11-12 22:42:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:42:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:42:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=
select *,isnull(og_domain,'') og_domain2 from orgs where og_id = 4
2015-11-12 22:42:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:45:16 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:45:17 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:45:17 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

update orgs set
	og_name = N'Credit Accelerator',
	og_domain = N'www.creditacclerator.come',
	og_active = 1,
	og_non_admins_can_use = 0,
	og_external_user = 1,
	og_can_edit_sql = 0,
	og_can_delete_bug = 0,
	og_can_edit_and_delete_posts = 0,
	og_can_merge_bugs = 0,
	og_can_mass_edit_bugs = 0,
	og_can_use_reports = 0,
	og_can_edit_reports = 0,
	og_can_be_assigned_to = 1,
	og_can_view_tasks = 0,
	og_can_edit_tasks = 0,
	og_can_search = 1,
	og_can_only_see_own_reported = 0,
	og_can_assign_to_internal_users = 0,
	og_other_orgs_permission_level = 0,
	og_project_field_permission_level = 2,
	og_org_field_permission_level = 2,
	og_category_field_permission_level = 2,
	og_tags_field_permission_level = 2,
	og_priority_field_permission_level = 2,
	og_status_field_permission_level = 2,
	og_assigned_to_field_permission_level = 2,
	og_udf_field_permission_level = 2
	
	where og_id = 4
2015-11-12 22:45:17 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:45:17 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:45:17 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:45:17 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:45:21 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:45:21 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:45:21 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=
select *,isnull(og_domain,'') og_domain2 from orgs where og_id = 4
2015-11-12 22:45:21 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0003
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

update orgs set
	og_name = N'Credit Accelerator',
	og_domain = N'www.creditacclerator.come',
	og_active = 1,
	og_non_admins_can_use = 0,
	og_external_user = 1,
	og_can_edit_sql = 0,
	og_can_delete_bug = 0,
	og_can_edit_and_delete_posts = 0,
	og_can_merge_bugs = 0,
	og_can_mass_edit_bugs = 0,
	og_can_use_reports = 0,
	og_can_edit_reports = 0,
	og_can_be_assigned_to = 1,
	og_can_view_tasks = 0,
	og_can_edit_tasks = 0,
	og_can_search = 1,
	og_can_only_see_own_reported = 0,
	og_can_assign_to_internal_users = 0,
	og_other_orgs_permission_level = 0,
	og_project_field_permission_level = 2,
	og_org_field_permission_level = 2,
	og_category_field_permission_level = 2,
	og_tags_field_permission_level = 2,
	og_priority_field_permission_level = 2,
	og_status_field_permission_level = 2,
	og_assigned_to_field_permission_level = 2,
	og_udf_field_permission_level = 2
	
	where og_id = 4
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:45:45 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:45:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:45:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0004
2015-11-12 22:45:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=
select *,isnull(og_domain,'') og_domain2 from orgs where og_id = 1
2015-11-12 22:45:48 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:46:35 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:46:35 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:46:35 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

update orgs set
	og_name = N'Prosper IT Consulting',
	og_domain = N'www.prosperitconsuling.com',
	og_active = 1,
	og_non_admins_can_use = 0,
	og_external_user = 0,
	og_can_edit_sql = 0,
	og_can_delete_bug = 0,
	og_can_edit_and_delete_posts = 0,
	og_can_merge_bugs = 0,
	og_can_mass_edit_bugs = 0,
	og_can_use_reports = 0,
	og_can_edit_reports = 0,
	og_can_be_assigned_to = 1,
	og_can_view_tasks = 0,
	og_can_edit_tasks = 0,
	og_can_search = 1,
	og_can_only_see_own_reported = 0,
	og_can_assign_to_internal_users = 0,
	og_other_orgs_permission_level = 2,
	og_project_field_permission_level = 2,
	og_org_field_permission_level = 2,
	og_category_field_permission_level = 2,
	og_tags_field_permission_level = 2,
	og_priority_field_permission_level = 2,
	og_status_field_permission_level = 2,
	og_assigned_to_field_permission_level = 2,
	og_udf_field_permission_level = 2
	
	where og_id = 1
2015-11-12 22:46:36 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:46:36 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:46:36 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:46:36 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:46:41 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:46:41 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:46:41 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=
select *,isnull(og_domain,'') og_domain2 from orgs where og_id = 1
2015-11-12 22:46:41 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

update orgs set
	og_name = N'Prosper IT Consulting',
	og_domain = N'www.prosperitconsulting.com',
	og_active = 1,
	og_non_admins_can_use = 0,
	og_external_user = 0,
	og_can_edit_sql = 0,
	og_can_delete_bug = 0,
	og_can_edit_and_delete_posts = 0,
	og_can_merge_bugs = 0,
	og_can_mass_edit_bugs = 0,
	og_can_use_reports = 0,
	og_can_edit_reports = 0,
	og_can_be_assigned_to = 1,
	og_can_view_tasks = 0,
	og_can_edit_tasks = 0,
	og_can_search = 1,
	og_can_only_see_own_reported = 0,
	og_can_assign_to_internal_users = 0,
	og_other_orgs_permission_level = 2,
	og_project_field_permission_level = 2,
	og_org_field_permission_level = 2,
	og_category_field_permission_level = 2,
	og_tags_field_permission_level = 2,
	og_priority_field_permission_level = 2,
	og_status_field_permission_level = 2,
	og_assigned_to_field_permission_level = 2,
	og_udf_field_permission_level = 2
	
	where og_id = 1
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 22:46:58 http://www.learncodinganywhere.com/bugtracker/edit_org.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:47:01 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0002
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0002
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:47:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0001
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 1
		if @last_updated > '20151112 22:47:03:663'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 22:47:03:663'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Create ''Customer'' user role',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 4,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 1
		end
		select @now
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 1

delete from bug_subscriptions
where bs_bug = 1
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 1
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 1
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 1
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 1
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 1)

insert into bug_subscriptions (bs_bug, bs_user)
select 1, us_id
from users
inner join bugs on bg_id = 1
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 1)
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
select count(1) from bug_subscriptions where bs_bug = 1 and bs_user = 1
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(1, 1, getdate(), N'changed assigned_to from "[not assigned]" to "erikg"', 'update')
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (3 <= us_reported_notifications and bg_reported_user = bs_user)
or (3 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (3 <= us_assigned_notifications and 4 = bs_user)
or (3 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 1
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:47:18  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:47:18  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0019
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:47:18  elapsed milliseconds:0000
2015-11-12 22:47:18  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 1
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:47:18  elapsed milliseconds:0000
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:47:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=1 elapsed milliseconds:0000
2015-11-12 22:47:18  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 1
2015-11-12 22:47:18  elapsed milliseconds:0000
2015-11-12 22:47:18  done updating Lucene index
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0002
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:50:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0002
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Decorate controller methods by user role', N'', 1,  1, getdate(), getdate(),
					0, 1,
					0, 0, 1, 0, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @now datetime
set @now = getdate()

insert into bug_posts
(bp_bug, bp_user, bp_date, bp_comment, bp_comment_search, bp_email_from, bp_email_cc, bp_type, bp_content_type,
bp_hidden_from_external_users)
values(
2,
1,
@now,
N'bugid#1',
N'bugid#1',
null,
N'',
N'comment',
N'text/plain',
0)
select scope_identity();
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 2

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 2
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join bugs on bg_id = 2
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 2
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:51:16  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:51:16  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:51:16  elapsed milliseconds:0000
2015-11-12 22:51:16  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 2
2015-11-12 22:51:16  elapsed milliseconds:0001
2015-11-12 22:51:16  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 2
2015-11-12 22:51:16  elapsed milliseconds:0003
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0016
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:51:16  done updating Lucene index
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0033
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:51:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0011
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0014
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:51:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0007
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 1
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 2
		if @last_updated > '20151112 22:51:16:857'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 22:51:16:857'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Decorate controller methods by user role',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 1,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 1,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 2
		end
		select @now
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 2

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 2
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join bugs on bg_id = 2
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
select count(1) from bug_subscriptions where bs_bug = 2 and bs_user = 1
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(2, 1, getdate(), N'changed category from "[no category]" to "task"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(2, 1, getdate(), N'changed priority from "[no priority]" to "high"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(2, 1, getdate(), N'changed assigned_to from "[not assigned]" to "admin"', 'update')
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (3 <= us_reported_notifications and bg_reported_user = bs_user)
or (3 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (3 <= us_assigned_notifications and 1 = bs_user)
or (3 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 2
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:52:10  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:52:10  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:52:10  elapsed milliseconds:0000
2015-11-12 22:52:10  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 2
2015-11-12 22:52:10  elapsed milliseconds:0000
2015-11-12 22:52:10  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 2
2015-11-12 22:52:10  elapsed milliseconds:0000
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0021
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:52:10 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:52:10  done updating Lucene index
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:52:28 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0002
2015-11-12 22:52:50 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:52:50 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 22:52:50 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 22:52:54 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:52:54 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0001
2015-11-12 22:52:54 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:52:54 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0026
2015-11-12 22:52:58 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:52:58 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:52:58 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 4
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 4

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 4
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 4
2015-11-12 22:52:58 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=
select count(1)
				from users where us_username = N'erikg' and us_id <> 4
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

update users set
us_username = N'erikg',
us_firstname = N'Erik',
us_lastname = N'Gross',
us_bugs_per_page = N'10',
us_use_fckeditor = 0,
us_enable_bug_list_popups = 1,
us_email = N'erik.d.gross@gmail.com',
us_active = 1,
us_admin = 1,
us_enable_notifications = 1,
us_send_notifications_to_self = 0,
us_reported_notifications = 4,
us_assigned_notifications = 4,
us_subscribed_notifications = 4,
us_auto_subscribe = 0,
us_auto_subscribe_own_bugs = 0,
us_auto_subscribe_reported_bugs = 0,
us_default_query = 1,
us_org = 1,
us_signature = N'',
us_forced_project = 0
where us_id = 4
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

		update project_user_xref
		set pu_auto_subscribe = 0,
		pu_admin = 0,
		pu_permission_level = 2
		where pu_user = 4;
			update project_user_xref
			set pu_permission_level = 2
			where pu_user = 4
			and pu_project in (2,1);
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 22:53:06 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=4 elapsed milliseconds:0024
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:53:09 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:53:10 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:10 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0002
2015-11-12 22:53:10 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:53:10 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:53:10 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:53:10 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:53:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0001
2015-11-12 22:53:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:53:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0004
2015-11-12 22:53:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:53:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0000
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0002
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0002
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0003
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:53:12 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 2
		if @last_updated > '20151112 22:53:12:470'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 22:53:12:470'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Decorate controller methods by user role',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 1,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 4,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 2
		end
		select @now
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 2

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 2
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join bugs on bg_id = 2
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
select count(1) from bug_subscriptions where bs_bug = 2 and bs_user = 1
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(2, 1, getdate(), N'changed assigned_to from "admin" to "erikg"', 'update')
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (3 <= us_reported_notifications and bg_reported_user = bs_user)
or (3 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (3 <= us_assigned_notifications and 4 = bs_user)
or (3 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 2
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:53:18  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:53:18  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:53:18  elapsed milliseconds:0000
2015-11-12 22:53:18  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 2
2015-11-12 22:53:18  elapsed milliseconds:0000
2015-11-12 22:53:18  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 2
2015-11-12 22:53:18  elapsed milliseconds:0000
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0018
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:53:18 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 22:53:18  done updating Lucene index
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:53:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'make guest user get logged out when they sign up', N'', 1,  1, getdate(), getdate(),
					0, 1,
					3, 1, 1, 4, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @now datetime
set @now = getdate()

insert into bug_posts
(bp_bug, bp_user, bp_date, bp_comment, bp_comment_search, bp_email_from, bp_email_cc, bp_type, bp_content_type,
bp_hidden_from_external_users)
values(
3,
1,
@now,
N'Need to log out the ''guest@creditaccelerator.com'' user before client creates their own account',
N'Need to log out the ''guest@creditaccelerator.com'' user before client creates their own account',
null,
N'',
N'comment',
N'text/plain',
0)
select scope_identity();
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 3

delete from bug_subscriptions
where bs_bug = 3
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 3
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 3
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 3
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 3)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 3)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 3
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 3)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, us_id
from users
inner join bugs on bg_id = 3
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 3)
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 3
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:54:50  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:54:50  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:54:50  elapsed milliseconds:0000
2015-11-12 22:54:50  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 3
2015-11-12 22:54:50  elapsed milliseconds:0001
2015-11-12 22:54:50  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 3
2015-11-12 22:54:50  elapsed milliseconds:0002
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0017
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5f66f107-c94b-4458-a99f-58aad05b80b7'
and us_active = 1
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 3
2015-11-12 22:54:50  done updating Lucene index
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0029
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0001
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:54:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0010
2015-11-12 22:55:14 http://www.learncodinganywhere.com/bugtracker/logoff.aspx sql=
delete from sessions
			where se_id = N'5f66f107-c94b-4458-a99f-58aad05b80b7'
			or datediff(d, se_date, getdate()) > 2
2015-11-12 22:55:14 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 22:55:35 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx elapsed milliseconds:0000
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select us_id from users where us_username = N'admin'
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx elapsed milliseconds:0000
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx guid=4d3af1ec-07d4-41e4-b4a3-e4f61e523095
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
insert into sessions (se_id, se_user) values('4d3af1ec-07d4-41e4-b4a3-e4f61e523095', 1)
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/default.aspx AppPath:/bugtracker
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '4d3af1ec-07d4-41e4-b4a3-e4f61e523095';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '4d3af1ec-07d4-41e4-b4a3-e4f61e523095'
and us_active = 1
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0017
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:55:46 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:57:41 http://www.learncodinganywhere.com/bugtracker/logoff.aspx sql=
delete from sessions
			where se_id = N'4d3af1ec-07d4-41e4-b4a3-e4f61e523095'
			or datediff(d, se_date, getdate()) > 2
2015-11-12 22:57:41 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 22:57:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 22:57:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'devinr'
2015-11-12 22:57:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off elapsed milliseconds:0002
2015-11-12 22:57:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 3
2015-11-12 22:57:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'devinr'
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off elapsed milliseconds:0000
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off guid=98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29', 3)
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off AppPath:/bugtracker
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29'
and us_active = 1
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0013
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 4
order by qu_desc
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0002
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 3)
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0003
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4  ) order by bg_id desc
2015-11-12 22:57:56 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0026
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off elapsed milliseconds:0000
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off elapsed milliseconds:0000
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off guid=0047959f-ac14-4691-a6f0-033d322a776a
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('0047959f-ac14-4691-a6f0-033d322a776a', 1)
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off AppPath:/bugtracker
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0016
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:58:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0002
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:58:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 3
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'test bug for Devin', N'', 1,  1, getdate(), getdate(),
					0, 4,
					1, 2, 1, 3, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

declare @now datetime
set @now = getdate()

insert into bug_posts
(bp_bug, bp_user, bp_date, bp_comment, bp_comment_search, bp_email_from, bp_email_cc, bp_type, bp_content_type,
bp_hidden_from_external_users)
values(
4,
1,
@now,
N'This is a test bug ',
N'This is a test bug ',
null,
N'',
N'comment',
N'text/plain',
0)
select scope_identity();
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 4

delete from bug_subscriptions
where bs_bug = 4
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 4
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 4
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 4, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 4
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 4)

insert into bug_subscriptions (bs_bug, bs_user)
select 4, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 4)

insert into bug_subscriptions (bs_bug, bs_user)
select 4, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 4
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 4)

insert into bug_subscriptions (bs_bug, bs_user)
select 4, us_id
from users
inner join bugs on bg_id = 4
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 4)
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 4
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 22:58:56  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 22:58:56  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 22:58:56  elapsed milliseconds:0000
2015-11-12 22:58:56  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 4
2015-11-12 22:58:56  elapsed milliseconds:0002
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0017
2015-11-12 22:58:56  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 4
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:58:56  elapsed milliseconds:0003
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 4
2015-11-12 22:58:56  done updating Lucene index
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 elapsed milliseconds:0028
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 elapsed milliseconds:0001
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 elapsed milliseconds:0000
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 4
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:58:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=4 elapsed milliseconds:0025
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29'
and us_active = 1
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 4
order by qu_desc
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 4
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4  ) order by bg_id desc
2015-11-12 22:59:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:59:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29'
and us_active = 1
2015-11-12 22:59:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:59:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 22:59:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4 order by bg_id desc
2015-11-12 22:59:13 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0024
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 22:59:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=4 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=4 elapsed milliseconds:0000
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=4 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 4
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=4 elapsed milliseconds:0008
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=4 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 4
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=4 elapsed milliseconds:0001
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 3
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0004
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:59:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 22:59:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 22:59:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:59:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 22:59:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 22:59:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 22:59:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 23:00:11 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29'
and us_active = 1
2015-11-12 23:00:11 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:00:11 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 3
2015-11-12 23:00:11 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status <> 5 and bg_assigned_to_user = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4  ) order by bg_id desc
2015-11-12 23:00:11 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0022
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0012
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:00:31 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0003
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Detect existing user arriving at Home/Index; don''t route them through Demo sequence', N'', 1,  1, getdate(), getdate(),
					0, 4,
					3, 1, 1, 4, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 5

delete from bug_subscriptions
where bs_bug = 5
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 5
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 5
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 5, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 5
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 5)

insert into bug_subscriptions (bs_bug, bs_user)
select 5, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 5)

insert into bug_subscriptions (bs_bug, bs_user)
select 5, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 5
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 5)

insert into bug_subscriptions (bs_bug, bs_user)
select 5, us_id
from users
inner join bugs on bg_id = 5
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 5)
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 5
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:01:49  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:01:49  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:01:49  elapsed milliseconds:0000
2015-11-12 23:01:49  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 5
2015-11-12 23:01:49  elapsed milliseconds:0002
2015-11-12 23:01:49  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 5
2015-11-12 23:01:49  elapsed milliseconds:0003
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0026
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:01:49  done updating Lucene index
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 elapsed milliseconds:0000
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 5
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 elapsed milliseconds:0033
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 elapsed milliseconds:0001
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:01:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 elapsed milliseconds:0000
2015-11-12 23:01:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 5
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:01:50 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=5 elapsed milliseconds:0011
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:01:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0002
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Create login ''splash'' animation for guest users', N'', 1,  1, getdate(), getdate(),
					0, 1,
					0, 0, 1, 0, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @now datetime
set @now = getdate()

insert into bug_posts
(bp_bug, bp_user, bp_date, bp_comment, bp_comment_search, bp_email_from, bp_email_cc, bp_type, bp_content_type,
bp_hidden_from_external_users)
values(
6,
1,
@now,
N'Bret described this well - an animated sequence, something like this:
"Gathering credit data..."
"Processing credit data.."
Creating personalized Credit Revitalization plan..."',
N'Bret described this well - an animated sequence, something like this:
"Gathering credit data..."
"Processing credit data.."
Creating personalized Credit Revitalization plan..."',
null,
N'',
N'comment',
N'text/plain',
0)
select scope_identity();
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 6

delete from bug_subscriptions
where bs_bug = 6
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 6
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 6
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 6
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 6
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, us_id
from users
inner join bugs on bg_id = 6
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 6)
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 6
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:07:29  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:07:29  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:07:29  elapsed milliseconds:0000
2015-11-12 23:07:29  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 6
2015-11-12 23:07:29  elapsed milliseconds:0003
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0020
2015-11-12 23:07:29  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 6
2015-11-12 23:07:29  elapsed milliseconds:0003
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:07:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0040
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0002
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:07:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0020
2015-11-12 23:07:30  done updating Lucene index
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0009
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 3
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:08:16 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 1 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 6
		if @last_updated > '20151112 23:07:30:017'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 23:07:30:017'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Create login ''splash'' animation for guest users',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 1,
			bg_category = 3,
			bg_priority = 2,
			bg_assigned_to_user = 4,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 6
		end
		select @now
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 6

delete from bug_subscriptions
where bs_bug = 6
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 6
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 6
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 6
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 6
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, us_id
from users
inner join bugs on bg_id = 6
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 6)
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
select count(1) from bug_subscriptions where bs_bug = 6 and bs_user = 1
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(6, 1, getdate(), N'changed category from "[no category]" to "task"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(6, 1, getdate(), N'changed priority from "[no priority]" to "med"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(6, 1, getdate(), N'changed assigned_to from "[not assigned]" to "erikg"', 'update')
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (3 <= us_reported_notifications and bg_reported_user = bs_user)
or (3 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (3 <= us_assigned_notifications and 4 = bs_user)
or (3 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 6
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:08:33  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:08:33  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:08:33  elapsed milliseconds:0000
2015-11-12 23:08:33  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 6
2015-11-12 23:08:33  elapsed milliseconds:0000
2015-11-12 23:08:33  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 6
2015-11-12 23:08:33  elapsed milliseconds:0000
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0018
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:08:33 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:08:33  done updating Lucene index
2015-11-12 23:08:36 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:08:36 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 23:08:36 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 23:08:40 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:08:40 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0001
2015-11-12 23:08:40 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 23:08:40 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0034
2015-11-12 23:08:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:08:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0001
2015-11-12 23:08:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 sql=

				select pj_id, pj_name,
				isnull(pu_permission_level,2) [pu_permission_level],
				isnull(pu_auto_subscribe,0) [pu_auto_subscribe],
				isnull(pu_admin,0) [pu_admin]
				from projects
				left outer join project_user_xref on pj_id = pu_project
				and pu_user = 3
				order by pj_name;/* populate query dropdown */
		    declare @org int
		    set @org = null
		    select @org = us_org from users where us_id = 3

			select qu_id, qu_desc
			from queries
			where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
			or isnull(qu_user,0) = 3
			or isnull(qu_org,0) = isnull(@org,-1)
			order by qu_desc;/* populate org dropdown 1 */
				select og_id, og_name
				from orgs
				order by og_name;
			select
				us_username,
				isnull(us_firstname,'') [us_firstname],
				isnull(us_lastname,'') [us_lastname],
				isnull(us_bugs_per_page,10) [us_bugs_per_page],
				us_use_fckeditor,
				us_enable_bug_list_popups,
				isnull(us_email,'') [us_email],
				us_active,
				us_admin,
				us_enable_notifications,
				us_send_notifications_to_self,
                us_reported_notifications,
                us_assigned_notifications,
                us_subscribed_notifications,
				us_auto_subscribe,
				us_auto_subscribe_own_bugs,
				us_auto_subscribe_reported_bugs,
				us_default_query,
				us_org,
				isnull(us_signature,'') [us_signature],
				isnull(us_forced_project,0) [us_forced_project],
				us_created_user
				from users
				where us_id = 3
2015-11-12 23:08:45 http://www.learncodinganywhere.com/bugtracker/edit_user.aspx?id=3 elapsed milliseconds:0001
2015-11-12 23:09:02 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:02 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0003
2015-11-12 23:09:02 http://www.learncodinganywhere.com/bugtracker/users.aspx sql=

			select distinct pu_user
			into #t
			from
			project_user_xref
			where pu_admin = 1;

			select u.us_id [id],
			'<a href=edit_user.aspx?id=' + convert(varchar,u.us_id) + '>edit</a>' [$no_sort_edit],
			'<a href=edit_user.aspx?copy=y&id=' + convert(varchar,u.us_id) + '>copy</a>' [$no_sort_add<br>like<br>this],
			'<a href=delete_user.aspx?id=' + convert(varchar,u.us_id) + '>delete</a>' [$no_sort_delete],

			u.us_username [username],
			isnull(u.us_firstname,'') + ' ' + isnull(u.us_lastname,'') [name],
			'<a sort=''' + og_name + ''' href=edit_org.aspx?id=' + convert(varchar,og_id) + '>' + og_name + '</a>' [org],
            isnull(u.us_email,'') [email],
			case when u.us_admin = 1 then 'Y' else 'N' end [admin],
			case when pu_user is null then 'N' else 'Y' end [project<br>admin],
			case when u.us_active = 1 then 'Y' else 'N' end [active],
			case when og_external_user = 1 then 'Y' else 'N' end [external],
			isnull(pj_name,'') [forced<br>project],
			isnull(qu_desc,'') [default query],
			case when u.us_enable_notifications = 1 then 'Y' else 'N' end [notif-<br>ications],
			u.us_most_recent_login_datetime [most recent login],
			u2.us_username [created<br>by]

			from users u
			inner join orgs on u.us_org = og_id
			left outer join queries on u.us_default_query = qu_id
			left outer join projects on u.us_forced_project = pj_id
			left outer join users u2 on u.us_created_user = u2.us_id
			left outer join #t on u.us_id = pu_user
			where u.us_active in (1 ,0)
			
			order by u.us_username;

			drop table #t
2015-11-12 23:09:02 http://www.learncodinganywhere.com/bugtracker/users.aspx elapsed milliseconds:0038
2015-11-12 23:09:08 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:08 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 23:09:08 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 23:09:10 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:10 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0001
2015-11-12 23:09:10 http://www.learncodinganywhere.com/bugtracker/projects.aspx sql=
select
		pj_id [id],
		'<a href=edit_project.aspx?&id=' + convert(varchar,pj_id) + '>edit</a>' [$no_sort_edit],
		'<a href=edit_user_permissions2.aspx?projects=y&id=' + convert(varchar,pj_id) + '>permissions</a>' [$no_sort_per user<br>permissions],
		'<a href=delete_project.aspx?id=' + convert(varchar,pj_id) + '>delete</a>' [$no_sort_delete],
		pj_name [project],
		case when pj_active = 1 then 'Y' else 'N' end [active],
		us_username [default user],
		case when isnull(pj_auto_assign_default_user,0) = 1 then 'Y' else 'N' end [auto assign<br>default user],
		case when isnull(pj_auto_subscribe_default_user,0) = 1 then 'Y' else 'N' end [auto subscribe<br>default user],
		case when isnull(pj_enable_pop3,0) = 1 then 'Y' else 'N' end [receive items<br>via pop3],
		pj_pop3_username [pop3 username],
		pj_pop3_email_from [from email addressl],
		case when pj_default = 1 then 'Y' else 'N' end [default]
		from projects
		left outer join users on us_id = pj_default_user
		order by pj_name
2015-11-12 23:09:10 http://www.learncodinganywhere.com/bugtracker/projects.aspx elapsed milliseconds:0000
2015-11-12 23:09:14 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:14 http://www.learncodinganywhere.com/bugtracker/admin.aspx elapsed milliseconds:0001
2015-11-12 23:09:14 http://www.learncodinganywhere.com/bugtracker/admin.aspx sql=
select count(1) from bugs
2015-11-12 23:09:16 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:16 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0001
2015-11-12 23:09:16 http://www.learncodinganywhere.com/bugtracker/orgs.aspx sql=
select og_id [id],
		'<a href=edit_org.aspx?id=' + convert(varchar,og_id) + '>edit</a>' [$no_sort_edit],
		'<a href=delete_org.aspx?id=' + convert(varchar,og_id) + '>delete</a>' [$no_sort_delete],
		og_name[desc],
		case when og_active = 1 then 'Y' else 'N' end [active],
		case when og_can_search = 1 then 'Y' else 'N' end [can<br>search],
		case when og_non_admins_can_use = 1 then 'Y' else 'N' end [non-admin<br>can use],
		case when og_can_only_see_own_reported = 1 then 'Y' else 'N' end [can see<br>only own bugs],
		case
			when og_other_orgs_permission_level = 0 then 'None'
			when og_other_orgs_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [other orgs<br>permission<br>level],
		case when og_external_user = 1 then 'Y' else 'N' end [external],
		case when og_can_be_assigned_to = 1 then 'Y' else 'N' end [can<br>be assigned to],
		case
			when og_status_field_permission_level = 0 then 'None'
			when og_status_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [status<br>permission<br>level],
		case
			when og_assigned_to_field_permission_level = 0 then 'None'
			when og_assigned_to_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [assigned to<br>permission<br>level],
		case
			when og_priority_field_permission_level = 0 then 'None'
			when og_priority_field_permission_level = 1 then 'Read Only'
			else 'Add/Edit' end [priority<br>permission<br>level],
		isnull(og_domain,'')[domain]
		from orgs order by og_name
2015-11-12 23:09:16 http://www.learncodinganywhere.com/bugtracker/orgs.aspx elapsed milliseconds:0000
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:09:22 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:09:26 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:26 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0002
2015-11-12 23:09:26 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:09:26 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0004
2015-11-12 23:09:26 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:09:26 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0001
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0001
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:09:27 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 3
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 6
		if @last_updated > '20151112 23:09:27:697'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 23:09:27:697'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Create login ''splash'' animation for guest users',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 2,
			bg_assigned_to_user = 3,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 6
		end
		select @now
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 6

delete from bug_subscriptions
where bs_bug = 6
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 6
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 6
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 6
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 6
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 6)

insert into bug_subscriptions (bs_bug, bs_user)
select 6, us_id
from users
inner join bugs on bg_id = 6
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 6)
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
select count(1) from bug_subscriptions where bs_bug = 6 and bs_user = 1
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(6, 1, getdate(), N'changed organization from "Prosper IT Consulting" to "Credit Accelerator"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(6, 1, getdate(), N'changed assigned_to from "erikg" to "devinr"', 'update')
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (3 <= us_reported_notifications and bg_reported_user = bs_user)
or (3 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (3 <= us_assigned_notifications and 3 = bs_user)
or (3 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 6
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:09:37  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0054
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 6
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:09:37  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:09:37  elapsed milliseconds:0000
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:09:37  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 6
2015-11-12 23:09:37  elapsed milliseconds:0000
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:09:37 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:09:37  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 6
2015-11-12 23:09:37  elapsed milliseconds:0000
2015-11-12 23:09:37  done updating Lucene index
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:09:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 2
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Devise storage scheme for client HTML credit reports', N'', 1,  1, getdate(), getdate(),
					0, 4,
					3, 1, 1, 2, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 7

delete from bug_subscriptions
where bs_bug = 7
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 7
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 7
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 7, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 7
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 7)

insert into bug_subscriptions (bs_bug, bs_user)
select 7, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 7)

insert into bug_subscriptions (bs_bug, bs_user)
select 7, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 7
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 7)

insert into bug_subscriptions (bs_bug, bs_user)
select 7, us_id
from users
inner join bugs on bg_id = 7
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 7)
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 7
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:11:21  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:11:21  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:11:21  elapsed milliseconds:0000
2015-11-12 23:11:21  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 7
2015-11-12 23:11:21  elapsed milliseconds:0002
2015-11-12 23:11:21  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 7
2015-11-12 23:11:21  elapsed milliseconds:0003
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0016
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 elapsed milliseconds:0000
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 7
2015-11-12 23:11:21  done updating Lucene index
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 elapsed milliseconds:0032
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 elapsed milliseconds:0001
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 elapsed milliseconds:0000
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 7
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:11:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=7 elapsed milliseconds:0011
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:11:35 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:12:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:12:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0015
2015-11-12 23:12:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 23:12:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:12:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 23:12:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Run code analysis on application', N'', 1,  1, getdate(), getdate(),
					0, 4,
					3, 1, 1, 4, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 8

delete from bug_subscriptions
where bs_bug = 8
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 8
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 8
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 8, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 8
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 8)

insert into bug_subscriptions (bs_bug, bs_user)
select 8, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 8)

insert into bug_subscriptions (bs_bug, bs_user)
select 8, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 8
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 8)

insert into bug_subscriptions (bs_bug, bs_user)
select 8, us_id
from users
inner join bugs on bg_id = 8
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 8)
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 8
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:12:30  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:12:30  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:12:30  elapsed milliseconds:0000
2015-11-12 23:12:30  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 8
2015-11-12 23:12:30  elapsed milliseconds:0004
2015-11-12 23:12:30  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 8
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0018
2015-11-12 23:12:30  elapsed milliseconds:0004
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0005
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:12:30  done updating Lucene index
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0038
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0001
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0000
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:12:30 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0013
2015-11-12 23:13:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:13:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0005
2015-11-12 23:13:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:13:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0001
2015-11-12 23:13:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:13:21 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=8 elapsed milliseconds:0000
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:13:25 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:28:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:28:39 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select count(1) from users
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'devinr'
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx elapsed milliseconds:0000
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 3
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
select us_id from users where us_username = N'devinr'
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx elapsed milliseconds:0000
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx guid=97759b9f-c82b-4222-b0a3-cf77f6758a6b
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx sql=
insert into sessions (se_id, se_user) values('97759b9f-c82b-4222-b0a3-cf77f6758a6b', 3)
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/default.aspx AppPath:/bugtracker
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0019
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 4
order by qu_desc
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 3)
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
 where /* altered - both  */ (  bg_status = 3  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4  ) order by bg_id desc
2015-11-12 23:28:47 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:29:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4 order by bg_id desc
2015-11-12 23:29:06 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:13 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:13 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:29:13 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 5
2015-11-12 23:29:13 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0003
2015-11-12 23:29:13 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 5
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:13 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:29:15 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:15 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0001
2015-11-12 23:29:15 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:15 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:15 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:15 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:17 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:17 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 23:29:17 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 23:29:17 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 23:29:17 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:17 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 23:29:21 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:21 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:21 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:21 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:21 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:21 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0001
2015-11-12 23:29:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0001
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0001
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0001
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0001
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 3
		if @last_updated > '20151112 23:29:23:737'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 23:29:23:737'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'make guest user get logged out when they sign up',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 4,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 3
		end
		select @now
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 3

delete from bug_subscriptions
where bs_bug = 3
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 3
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 3
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 3
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 3)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 3)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 3
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 3)

insert into bug_subscriptions (bs_bug, bs_user)
select 3, us_id
from users
inner join bugs on bg_id = 3
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 3)
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
select count(1) from bug_subscriptions where bs_bug = 3 and bs_user = 1
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(3, 1, getdate(), N'changed organization from "Prosper IT Consulting" to "Credit Accelerator"', 'update')
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (4 <= us_reported_notifications and bg_reported_user = bs_user)
or (4 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (4 <= us_assigned_notifications and 4 = bs_user)
or (4 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 3
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:29:29  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:29:29  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:29:29  elapsed milliseconds:0000
2015-11-12 23:29:29  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 3
2015-11-12 23:29:29  elapsed milliseconds:0000
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0020
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:29  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 3
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:29:29  elapsed milliseconds:0000
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:29 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=3 elapsed milliseconds:0000
2015-11-12 23:29:29  done updating Lucene index
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:29:33 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 4
order by qu_desc
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4 order by bg_id desc
2015-11-12 23:29:34 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0001
2015-11-12 23:29:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 5
2015-11-12 23:29:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:29:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 5
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:35 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:29:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0001
2015-11-12 23:29:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:29:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:36 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:29:37 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:37 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0001
2015-11-12 23:29:37 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 2
2015-11-12 23:29:37 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0000
2015-11-12 23:29:37 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:37 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0000
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 4
order by qu_desc
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4 order by bg_id desc
2015-11-12 23:29:38 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0002
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:39 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 23:29:43 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:29:43 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:43 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 8
2015-11-12 23:29:43 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select bp_bug, sum(bp_size) bytes 
 into #t 
 from bug_posts 
 where bp_type = 'file' 
 group by bp_bug 
 select '#ffffff', bg_id [id], bg_short_desc [desc], 
 bytes, rpt.us_username [reported by] 
 from bugs 
 inner join #t on bp_bug = bg_id 
 left outer join users rpt on rpt.us_id = bg_reported_user 
 WhErE /* altered - both  */ (  1 = 1 
  ) AND (  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4  ) order by bytes desc 
 drop table #t 
2015-11-12 23:29:43 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0017
2015-11-12 23:29:44 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:29:44 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:44 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:44 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4 order by bg_id desc
2015-11-12 23:29:44 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0002
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0002
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0001
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 4
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 2
		if @last_updated > '20151112 23:29:39:280'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 23:29:39:280'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Decorate controller methods by user role',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 4,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 2
		end
		select @now
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 2

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 2
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 2
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 2
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 2)

insert into bug_subscriptions (bs_bug, bs_user)
select 2, us_id
from users
inner join bugs on bg_id = 2
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 2)
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
select count(1) from bug_subscriptions where bs_bug = 2 and bs_user = 1
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(2, 1, getdate(), N'changed organization from "Prosper IT Consulting" to "Credit Accelerator"', 'update')
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (4 <= us_reported_notifications and bg_reported_user = bs_user)
or (4 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (4 <= us_assigned_notifications and 4 = bs_user)
or (4 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 2
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:29:45  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:29:45  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:29:45  elapsed milliseconds:0000
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0018
2015-11-12 23:29:45  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 2
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 2
2015-11-12 23:29:45  elapsed milliseconds:0000
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:29:45 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=2 elapsed milliseconds:0000
2015-11-12 23:29:45  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 2
2015-11-12 23:29:45  elapsed milliseconds:0000
2015-11-12 23:29:45  done updating Lucene index
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 3
or isnull(qu_org,0) = 4
order by qu_desc
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 3 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 3
					and pu_permission_level = 0)) 
					    and bugs.bg_org = 4 order by bg_id desc
2015-11-12 23:29:54 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:29:58 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:30:00 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:30:00 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:30:00 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 5
2015-11-12 23:30:00 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:30:00 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 5
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:00 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=5 elapsed milliseconds:0000
2015-11-12 23:30:23 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:30:23 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:30:23 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 3
where bg_id = 6
2015-11-12 23:30:23 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0004
2015-11-12 23:30:23 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:23 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0011
2015-11-12 23:30:28 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:30:28 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0001
2015-11-12 23:30:28 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 3
where bg_id = 8
2015-11-12 23:30:28 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0004
2015-11-12 23:30:28 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:28 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0011
2015-11-12 23:30:31 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:30:31 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0001
2015-11-12 23:30:31 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 3
where bg_id = 6
2015-11-12 23:30:31 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:30:31 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:31 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	4 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 3
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 3
left outer join project_user_xref on pj_id = pu_project
and pu_user = 3
where bg_id = 6
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0033
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 3
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0012
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (0 <> 0 or 4 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0011
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:32 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:30:48 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:30:48 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:30:48 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 3
where bg_id = 6
2015-11-12 23:30:48 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:30:48 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:48 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=6 elapsed milliseconds:0000
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '97759b9f-c82b-4222-b0a3-cf77f6758a6b'
and us_active = 1
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	4 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 3
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 3
left outer join project_user_xref on pj_id = pu_project
and pu_user = 3
where bg_id = 6
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 3
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0001
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (0 <> 0 or 4 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 6
and a.bp_parent is null
 and a.bp_type <> 'update'
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:30:49 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=6 elapsed milliseconds:0000
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0005
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0001
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0001
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:32:52 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:36:50 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '0047959f-ac14-4691-a6f0-033d322a776a';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '0047959f-ac14-4691-a6f0-033d322a776a'
and us_active = 1
2015-11-12 23:36:50 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0001
2015-11-12 23:36:50 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 3
2015-11-12 23:36:50 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:36:50 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 3
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:36:50 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=3 elapsed milliseconds:0000
2015-11-12 23:37:05 http://www.learncodinganywhere.com/bugtracker/logoff.aspx sql=
delete from sessions
			where se_id = N'0047959f-ac14-4691-a6f0-033d322a776a'
			or datediff(d, se_date, getdate()) > 2
2015-11-12 23:37:05 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 23:37:51 http://www.learncodinganywhere.com/bugtracker/logoff.aspx sql=
delete from sessions
			where se_id = N'98dd3cb7-ae6a-48f9-89cc-a4e3b2798f29'
			or datediff(d, se_date, getdate()) > 2
2015-11-12 23:37:51 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select count(1) from users
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=

select us_username, us_id, us_password, isnull(us_salt,0) us_salt, us_active
from users
where us_username = N'admin'
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off elapsed milliseconds:0001
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
update users set us_most_recent_login_datetime = getdate() where us_id = 1
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
select us_id from users where us_username = N'admin'
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off elapsed milliseconds:0000
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off guid=5c381b95-5344-4c56-8bf6-78bf1c814e69
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off sql=
insert into sessions (se_id, se_user) values('5c381b95-5344-4c56-8bf6-78bf1c814e69', 1)
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/default.aspx?msg=logged+off AppPath:/bugtracker
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0011
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_id, qu_sql from queries where qu_id in
			(select us_default_query from users where us_id = 1)
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:37:55 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0002
2015-11-12 23:38:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:38:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0001
2015-11-12 23:38:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:38:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:38:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:38:11 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:38:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 2
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Make log4net logs go to sql server', N'', 1,  1, getdate(), getdate(),
					0, 4,
					3, 2, 1, 2, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 9

delete from bug_subscriptions
where bs_bug = 9
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 9
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 9
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 9
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 9)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 9)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 9
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 9)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, us_id
from users
inner join bugs on bg_id = 9
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 9)
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 9
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:38:56  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:38:56  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:38:56  elapsed milliseconds:0000
2015-11-12 23:38:56  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 9
2015-11-12 23:38:56  elapsed milliseconds:0002
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0017
2015-11-12 23:38:56  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 9
2015-11-12 23:38:56  elapsed milliseconds:0003
2015-11-12 23:38:56  done updating Lucene index
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0001
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 9
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0032
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0001
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 9
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:38:56 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0010
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:39:03 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 0
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
insert into bugs
					(bg_short_desc,
					bg_tags,
					bg_reported_user,
					bg_last_updated_user,
					bg_reported_date,
					bg_last_updated_date,
					bg_project,
					bg_org,
					bg_category,
					bg_priority,
					bg_status,
					bg_assigned_to_user,
					bg_user_defined_attribute,
					bg_project_custom_dropdown_value1,
					bg_project_custom_dropdown_value2,
					bg_project_custom_dropdown_value3
					)
					values (N'Add in logging at each unit of work in the app', N'', 1,  1, getdate(), getdate(),
					0, 1,
					0, 0, 1, 0, 0,
					N'',N'',N'' )
select scope_identity()
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @now datetime
set @now = getdate()

insert into bug_posts
(bp_bug, bp_user, bp_date, bp_comment, bp_comment_search, bp_email_from, bp_email_cc, bp_type, bp_content_type,
bp_hidden_from_external_users)
values(
10,
1,
@now,
N'Don''t log when inside a loop',
N'Don''t log when inside a loop',
null,
N'',
N'comment',
N'text/plain',
0)
select scope_identity();
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 10

delete from bug_subscriptions
where bs_bug = 10
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 10
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 10
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 10
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 10)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 10)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 10
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 10)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, us_id
from users
inner join bugs on bg_id = 10
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 10)
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (1 <= us_reported_notifications and bg_reported_user = bs_user)
or (1 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (1 <= us_assigned_notifications and 0 = bs_user)
or (1 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 10
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:40:08  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:40:08  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:40:08  elapsed milliseconds:0002
2015-11-12 23:40:08  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 10
2015-11-12 23:40:08  elapsed milliseconds:0002
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0019
2015-11-12 23:40:08  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 10
2015-11-12 23:40:08  elapsed milliseconds:0003
2015-11-12 23:40:08  done updating Lucene index
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0029
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0001
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:40:08 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0010
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0001
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0002
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:40:42 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=0 elapsed milliseconds:0000
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0002
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

select top 1 pj_id from projects where pj_default = 1 order by pj_name;
select top 1 ct_id from categories where ct_default = 1 order by ct_name;
select top 1 pr_id from priorities where pr_default = 1 order by pr_name;
select top 1 st_id from statuses where st_default = 1 order by st_name;
select top 1 udf_id from user_defined_attribute where udf_default = 1 order by udf_name;
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0000
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:40:43 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx elapsed milliseconds:0001
2015-11-12 23:40:45 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=7 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:45 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=7 elapsed milliseconds:0000
2015-11-12 23:40:45 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=7 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 7
2015-11-12 23:40:45 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=7 elapsed milliseconds:0003
2015-11-12 23:40:45 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=7 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 7
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:40:45 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=7 elapsed milliseconds:0000
2015-11-12 23:40:47 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:47 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0001
2015-11-12 23:40:47 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 1
2015-11-12 23:40:47 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 23:40:47 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 1
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:40:47 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=1 elapsed milliseconds:0000
2015-11-12 23:40:49 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:49 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0001
2015-11-12 23:40:49 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:40:49 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:40:49 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:40:49 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:40:52 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 elapsed milliseconds:0000
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 elapsed milliseconds:0003
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 elapsed milliseconds:0000
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0001
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:40:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:41:19 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:41:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 elapsed milliseconds:0000
2015-11-12 23:41:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:41:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 elapsed milliseconds:0000
2015-11-12 23:41:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:22 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=10 elapsed milliseconds:0000
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0001
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:23 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0001
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0001
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 10
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 10
		if @last_updated > '20151112 23:41:23:300'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 23:41:23:300'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Add in logging at each unit of work in the app',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 1,
			bg_assigned_to_user = 10,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 10
		end
		select @now
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 10

delete from bug_subscriptions
where bs_bug = 10
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 10
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 10
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 10
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 10)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 10)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 10
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 10)

insert into bug_subscriptions (bs_bug, bs_user)
select 10, us_id
from users
inner join bugs on bg_id = 10
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 10)
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
select count(1) from bug_subscriptions where bs_bug = 10 and bs_user = 1
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(10, 1, getdate(), N'changed organization from "Prosper IT Consulting" to "Credit Accelerator"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(10, 1, getdate(), N'changed category from "[no category]" to "task"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(10, 1, getdate(), N'changed priority from "[no priority]" to "high"', 'update')
		insert into bug_posts
		(bp_bug, bp_user, bp_date, bp_comment, bp_type)
		values(10, 1, getdate(), N'changed assigned_to from "[not assigned]" to "cliffc"', 'update')
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (3 <= us_reported_notifications and bg_reported_user = bs_user)
or (3 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (3 <= us_assigned_notifications and 10 = bs_user)
or (3 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 10
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:41:47  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:41:47  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:41:47  elapsed milliseconds:0000
2015-11-12 23:41:47  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 10
2015-11-12 23:41:47  elapsed milliseconds:0000
2015-11-12 23:41:47  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 10
2015-11-12 23:41:47  elapsed milliseconds:0000
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0046
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:41:47  done updating Lucene index
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0001
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_hidden_from_external_users = 0
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0017
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 10
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 10
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:47 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=10 elapsed milliseconds:0000
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
/* query dropdown */
select qu_id, qu_desc
from queries
where (isnull(qu_user,0) = 0 and isnull(qu_org,0) = 0)
or isnull(qu_user,0) = 1
or isnull(qu_org,0) = 1
order by qu_desc
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0000
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select qu_sql from queries where qu_id = 1
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx sql=
select isnull(pr_background_color,'#ffffff'), bg_id [id], isnull(bu_flag,0) [$FLAG], 
 bg_short_desc [desc], isnull(pj_name,'') [project], isnull(og_name,'') [organization], isnull(ct_name,'') [category], rpt.us_username [reported by],
 bg_reported_date [reported on], isnull(pr_name,'') [priority], isnull(asg.us_username,'') [assigned to],
 isnull(st_name,'') [status], isnull(lu.us_username,'') [last updated by], bg_last_updated_date [last updated on]
 from bugs 
 left outer join bug_user on bu_bug = bg_id and bu_user = 1 
 left outer join users rpt on rpt.us_id = bg_reported_user
 left outer join users asg on asg.us_id = bg_assigned_to_user
 left outer join users lu on lu.us_id = bg_last_updated_user
 left outer join projects on pj_id = bg_project
 left outer join orgs on og_id = bg_org
 left outer join categories on ct_id = bg_category
 left outer join priorities on pr_id = bg_priority
 left outer join statuses on st_id = bg_status
  /* altered - just order by  */ WHERE  (bugs.bg_project not in (
					select pu_project
					from project_user_xref
					where pu_user = 1
					and pu_permission_level = 0)) order by bg_id desc
2015-11-12 23:41:51 http://www.learncodinganywhere.com/bugtracker/bugs.aspx elapsed milliseconds:0001
2015-11-12 23:41:53 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:53 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0001
2015-11-12 23:41:53 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 2
2015-11-12 23:41:53 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0000
2015-11-12 23:41:53 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 2
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:53 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=2 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0001
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 8
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 8
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=8 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=9 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=9 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=9 sql=

declare @bg_org int

select isnull(pu_permission_level,2),
bg_org
from bugs
left outer join project_user_xref
on pu_project = bg_project
and pu_user = 1
where bg_id = 9
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=9 elapsed milliseconds:0003
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=9 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 9
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/ajax.aspx?bugid=9 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 9
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0001
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
/* drop downs */ select pj_id, pj_name
		from projects
		left outer join project_user_xref on pj_id = pu_project
		and pu_user = 1
		where pj_active = 1
		and isnull(pu_permission_level,2) not in (0, 1)
		order by pj_name;
select og_id, og_name from orgs where og_active = 1 order by og_name;
select ct_id, ct_name from categories order by ct_sort_seq, ct_name;
select pr_id, pr_name from priorities order by pr_sort_seq, pr_name;
select st_id, st_name from statuses order by st_sort_seq, st_name;
select udf_id, udf_name from user_defined_attribute order by udf_sort_seq, udf_name;
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0001
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 9
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:41:55 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* check session */
declare @project_admin int
select @project_admin = count(1)
	from sessions
	inner join project_user_xref on pu_user = se_user
	and pu_admin = 1
	where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69';

select us_id, us_admin,
us_username, us_firstname, us_lastname,
isnull(us_email,'') us_email,
isnull(us_bugs_per_page,10) us_bugs_per_page,
isnull(us_forced_project,0) us_forced_project,
us_use_fckeditor,
us_enable_bug_list_popups,
og.*,
isnull(us_forced_project, 0 ) us_forced_project,
isnull(pu_permission_level, 2) pu_permission_level,
@project_admin [project_admin]
from sessions
inner join users on se_user = us_id
inner join orgs og on us_org = og_id
left outer join project_user_xref
	on pu_project = us_forced_project
	and pu_user = us_id
where se_id = '5c381b95-5344-4c56-8bf6-78bf1c814e69'
and us_active = 1
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
 /* get_bug_datarow */
declare @svn_revisions int
declare @git_commits int
declare @hg_revisions int
declare @tasks int
declare @related int;
set @svn_revisions = 0
set @git_commits = 0
set @hg_revisions = 0
set @tasks = 0
set @related = 0

select bg_id [id],
bg_short_desc [short_desc],
isnull(bg_tags,'') [bg_tags],
isnull(ru.us_username,'[deleted user]') [reporter],
isnull(ru.us_email,'') [reporter_email],
case rtrim(ru.us_firstname)
	when null then isnull(ru.us_lastname, '')
	when '' then isnull(ru.us_lastname, '')
	else isnull(ru.us_lastname + ', ' + ru.us_firstname,'')
	end [reporter_fullname],
bg_reported_date [reported_date],
datediff(s,bg_reported_date,getdate()) [seconds_ago],
isnull(lu.us_username,'') [last_updated_user],
case rtrim(lu.us_firstname)
	when null then isnull(lu.us_lastname, '')
	when '' then isnull(lu.us_lastname, '')
	else isnull(lu.us_lastname + ', ' + lu.us_firstname,'')
	end [last_updated_fullname],


bg_last_updated_date [last_updated_date],
isnull(bg_project,0) [project],
isnull(pj_name,'[no project]') [current_project],

isnull(bg_org,0) [organization],
isnull(bugorg.og_name,'') [og_name],

isnull(bg_category,0) [category],
isnull(ct_name,'') [category_name],

isnull(bg_priority,0) [priority],
isnull(pr_name,'') [priority_name],

isnull(bg_status,0) [status],
isnull(st_name,'') [status_name],

isnull(bg_user_defined_attribute,0) [udf],
isnull(udf_name,'') [udf_name],

isnull(bg_assigned_to_user,0) [assigned_to_user],
isnull(asg.us_username,'[not assigned]') [assigned_to_username],
case rtrim(asg.us_firstname)
when null then isnull(asg.us_lastname, '[not assigned]')
when '' then isnull(asg.us_lastname, '[not assigned]')
else isnull(asg.us_lastname + ', ' + asg.us_firstname,'[not assigned]')
end [assigned_to_fullname],

isnull(bs_user,0) [subscribed],

case
when
	1 <> bg_org
	and userorg.og_other_orgs_permission_level < 2
	and userorg.og_other_orgs_permission_level < isnull(pu_permission_level,2)
		then userorg.og_other_orgs_permission_level
else
	isnull(pu_permission_level,2)
end [pu_permission_level],

isnull(bg_project_custom_dropdown_value1,'') [bg_project_custom_dropdown_value1],
isnull(bg_project_custom_dropdown_value2,'') [bg_project_custom_dropdown_value2],
isnull(bg_project_custom_dropdown_value3,'') [bg_project_custom_dropdown_value3],
@related [relationship_cnt],
@svn_revisions [svn_revision_cnt],
@git_commits [git_commit_cnt],
@hg_revisions [hg_commit_cnt],
@tasks [task_cnt],
getdate() [snapshot_timestamp]

from bugs
inner join users this_user on us_id = 1
inner join orgs userorg on this_user.us_org = userorg.og_id
left outer join user_defined_attribute on bg_user_defined_attribute = udf_id
left outer join projects on bg_project = pj_id
left outer join orgs bugorg on bg_org = bugorg.og_id
left outer join categories on bg_category = ct_id
left outer join priorities on bg_priority = pr_id
left outer join statuses on bg_status = st_id
left outer join users asg on bg_assigned_to_user = asg.us_id
left outer join users ru on bg_reported_user = ru.us_id
left outer join users lu on bg_last_updated_user = lu.us_id
left outer join bug_subscriptions on bs_bug = bg_id and bs_user = 1
left outer join project_user_xref on pj_id = pu_project
and pu_user = 1
where bg_id = 9
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* validate org versus assigned_to */
select case when og_other_orgs_permission_level <> 0
or 4 = og_id then 1
else 0 end as [answer]
from users
inner join orgs on us_org = og_id
where us_id = 2
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
declare @permission_level int
		set @permission_level = -1
		select @permission_level = isnull(pu_permission_level,2)
		from project_user_xref
		where pu_project = 0
		and pu_user = 1
		if @permission_level = -1 set @permission_level = 2
		select @permission_level
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
declare @now datetime
		declare @last_updated datetime
		select @last_updated = bg_last_updated_date from bugs where bg_id = 9
		if @last_updated > '20151112 23:41:55:820'
		begin
			-- signal that we did NOT do the update
			set @now = '20151112 23:41:55:820'
		end
		else
		begin
			-- signal that we DID do the update
			set @now = getdate()

			update bugs set
			bg_short_desc = N'Make log4net logs go to sql server',
			bg_tags = N'',
			bg_project = 0,
			bg_org = 4,
			bg_category = 3,
			bg_priority = 2,
			bg_assigned_to_user = 2,
			bg_status = 1,
			bg_last_updated_user = 1,
			bg_last_updated_date = @now,
			bg_user_defined_attribute = 0
            ,
bg_project_custom_dropdown_value1 = N'',
bg_project_custom_dropdown_value2 = N'',
bg_project_custom_dropdown_value3 = N''
	
			
			where bg_id = 9
		end
		select @now
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

declare @pj int
select @pj = bg_project from bugs where bg_id = 9

delete from bug_subscriptions
where bs_bug = 9
and bs_user in
(select x.pu_user
from projects
left outer join project_user_xref x on pu_project = pj_id
where pu_project = @pj
and isnull(pu_permission_level,2) = 0)

delete from bug_subscriptions
where bs_bug = 9
and bs_user in
(select us_id from users
 inner join orgs on us_org = og_id
 inner join bugs on bg_id = 9
 where og_other_orgs_permission_level = 0
 and bg_org <> og_id)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, us_id
from users
inner join orgs on us_org = og_id
inner join bugs on bg_id = 9
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where us_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 9)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, pj_default_user
from projects
inner join users on pj_default_user = us_id
where pj_id = @pj
and pj_default_user <> 0
and pj_auto_subscribe_default_user = 1
and us_active = 1
and pj_default_user not in
(select bs_user from bug_subscriptions
where bs_bug = 9)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, pu_user from project_user_xref
inner join users on pu_user = us_id
inner join orgs on us_org = og_id
inner join bugs on bg_id = 9
where pu_auto_subscribe = 1
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and pu_project = @pj
and pu_user not in
(select bs_user from bug_subscriptions
where bs_bug = 9)

insert into bug_subscriptions (bs_bug, bs_user)
select 9, us_id
from users
inner join bugs on bg_id = 9
inner join orgs on us_org = og_id
left outer join project_user_xref on pu_project = @pj and pu_user = us_id
where ((us_auto_subscribe_own_bugs = 1 and bg_assigned_to_user = us_id)
or
(us_auto_subscribe_reported_bugs = 1 and bg_reported_user = us_id))
and
case
	when
		us_org <> bg_org
		and og_other_orgs_permission_level < 2
		and og_other_orgs_permission_level < isnull(pu_permission_level,2)
			then og_other_orgs_permission_level
	else
		isnull(pu_permission_level,2)
end <> 0
and us_active = 1
and us_id not in
(select bs_user from bug_subscriptions
where bs_bug = 9)
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=
select count(1) from bug_subscriptions where bs_bug = 9 and bs_user = 1
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

declare @now datetime
set @now = getdate()

insert into bug_posts
(bp_bug, bp_user, bp_date, bp_comment, bp_comment_search, bp_email_from, bp_email_cc, bp_type, bp_content_type,
bp_hidden_from_external_users)
values(
9,
1,
@now,
N'See Erik about how to implement this BEFORE working on it.',
N'See Erik about how to implement this BEFORE working on it.',
null,
N'',
N'comment',
N'text/plain',
0)
select scope_identity();
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* get notification emails for all subscribers */
select us_email, us_id, us_admin, og.*
from bug_subscriptions
inner join users on bs_user = us_id
inner join orgs og on us_org = og_id
inner join bugs on bg_id = bs_bug
left outer join project_user_xref on pu_user = us_id and pu_project = bg_project
where us_email is not null
and us_enable_notifications = 1
-- $status_change
and us_active = 1
and us_email <> ''
and (   (4 <= us_reported_notifications and bg_reported_user = bs_user)
or (4 <= us_assigned_notifications and bg_assigned_to_user = bs_user)
or (4 <= us_assigned_notifications and 2 = bs_user)
or (4 <= us_subscribed_notifications))
and
case
when
us_org <> bg_org
and og_other_orgs_permission_level < 2
and og_other_orgs_permission_level < isnull(pu_permission_level,2)
	then og_other_orgs_permission_level
else
isnull(pu_permission_level,2)
end <> 0
and bs_bug = 9
and (us_id <> 1 or isnull(us_send_notifications_to_self,0) = 1)
2015-11-12 23:42:14  started updating Lucene index using folder C:\inetpub\wwwroot\newWebsite\bugtracker\btnet364\www\App_Data\lucene_index
2015-11-12 23:42:14  sql=

/* get searchable cols */					
select sc.name
from syscolumns sc
inner join systypes st on st.xusertype = sc.xusertype
inner join sysobjects so on sc.id = so.id
where so.name = 'bugs'
and st.[name] <> 'sysname'
and sc.name not in ('rowguid',
'bg_id',
'bg_short_desc',
'bg_reported_user',
'bg_reported_date',
'bg_project',
'bg_org',
'bg_category',
'bg_priority',
'bg_status',
'bg_assigned_to_user',
'bg_last_updated_user',
'bg_last_updated_date',
'bg_user_defined_attribute',
'bg_project_custom_dropdown_value1',
'bg_project_custom_dropdown_value2',
'bg_project_custom_dropdown_value3',
'bg_tags')
and st.[name] in ('nvarchar','varchar')
and sc.length > 30
2015-11-12 23:42:14  elapsed milliseconds:0000
2015-11-12 23:42:14  sql=

select bg_id, 

isnull(bg_tags,'') bg_tags,
bg_short_desc    
from bugs where bg_id = 9
2015-11-12 23:42:14  elapsed milliseconds:0000
2015-11-12 23:42:14  sql=

select bp_bug, bp_id, 
isnull(bp_comment_search,bp_comment) [text] 
from bug_posts 
where bp_type <> 'update'
and bp_hidden_from_external_users = 0
and bp_bug = 9
2015-11-12 23:42:14  elapsed milliseconds:0000
2015-11-12 23:42:14  done updating Lucene index
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0031
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* users this project */ select us_id, case when 0 = 1 then us_lastname + ', ' + us_firstname else us_username end us_username
from users
inner join orgs on us_org = og_id
where us_active = 1
and og_can_be_assigned_to = 1
and (2 <> 0 or 1 = og_id or (og_external_user = 0 and 0 = 1))
and us_id not in
	(select pu_user from project_user_xref
		where pu_project = 0
		and pu_permission_level = 0)
order by us_username; 
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 sql=

/* get_bug_posts */
select
a.bp_bug,
a.bp_comment,
isnull(us_username,'') [us_username],
case rtrim(us_firstname)
	when null then isnull(us_lastname, '')
	when '' then isnull(us_lastname, '')
	else isnull(us_lastname + ', ' + us_firstname,'')
	end [us_fullname],
isnull(us_email,'') [us_email],
a.bp_date,
datediff(s,a.bp_date,getdate()) [seconds_ago],
a.bp_id,
a.bp_type,
isnull(a.bp_email_from,'') bp_email_from,
isnull(a.bp_email_to,'') bp_email_to,
isnull(a.bp_email_cc,'') bp_email_cc,
isnull(a.bp_file,'') bp_file,
isnull(a.bp_size,0) bp_size,
isnull(a.bp_content_type,'') bp_content_type,
a.bp_hidden_from_external_users,
isnull(ba.bp_file,'') ba_file,  -- intentionally ba
isnull(ba.bp_id,'') ba_id, -- intentionally ba
isnull(ba.bp_size,'') ba_size,  -- intentionally ba
isnull(ba.bp_content_type,'') ba_content_type -- intentionally ba
from bug_posts a
left outer join users on us_id = a.bp_user
left outer join bug_posts ba on ba.bp_parent = a.bp_id and ba.bp_bug = a.bp_bug
where a.bp_bug = 9
and a.bp_parent is null
 and a.bp_type <> 'update'
 order by a.bp_id desc, ba.bp_parent, ba.bp_id
2015-11-12 23:42:14 http://www.learncodinganywhere.com/bugtracker/edit_bug.aspx?id=9 elapsed milliseconds:0000
2015-11-12 23:42:47  actually_send_the_emails
2015-11-12 23:42:47  sql=
select * from queued_notifications where qn_status = N'not sent' and qn_retries < 3
2015-11-12 23:42:47  elapsed milliseconds:0023
2015-11-12 23:42:47  sending email to cliffordcan@gmail.com
2015-11-12 23:42:47  to email addr: cliffordcan@gmail.com
2015-11-12 23:42:47  There was a problem sending email.   Check settings in Web.config.
2015-11-12 23:42:47  TO:cliffordcan@gmail.com
2015-11-12 23:42:47  FROM:dont_reply@example.com
2015-11-12 23:42:47  SUBJECT:Bug:10 was updated - Add in logging at each unit of work in the app  (DO NOT EDIT THIS:10)
2015-11-12 23:42:47  Could not find a part of the path 'C:\temp\pickup\eb3ccf02-89d2-44b0-bb1b-55e461b9f592.eml'.
2015-11-12 23:42:47  sql=
update queued_notifications  set qn_retries = qn_retries + 1, qn_last_exception = N'Could not find a part of the path ''C:\temp\pickup\eb3ccf02-89d2-44b0-bb1b-55e461b9f592.eml''.' where qn_id = 1
